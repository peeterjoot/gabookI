%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\label{chap:stokesTheoremGeometricAlgebra}

The subject of \textAndIndex{differential forms} is one way to obtain an understanding of how to apply \textAndIndex{Stokes theorem} to higher dimensional spaces, non-Euclidean metrics, and \textAndIndex{curvilinear coordinate} systems.
%as covered for example in
%, and \citep{spivak1965calculus}.  However, both of those texts, despite their small size, are intensely scary.
%
The formalism of differential forms requires reexpressing physical quantities as ``forms''.  A notable example, as given in \citep{flanders1989dfa}, introduces a \textAndIndex{two-form} for the Faraday field

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:5850}
\alpha
=
\lr{ E_1 dx^1 + E_2 dx^2 + E_3 dx^3 } \wedge (c dt)
+
\lr{
 H_1 dx^2 \wedge dx^3
 H_2 dx^3 \wedge dx^1
 H_3 dx^1 \wedge dx^2
}.
\end{dmath}

With a metric for which \((c dt, c dt) = -1\), and a cooresponding notion of \textAndIndex{duality} (*), Maxwell's equations for freespace become

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:5870}
\begin{aligned}
d\alpha &= 0 \\
d\conj\alpha &= 0.
\end{aligned}
\end{equation}

These are equivalent to the usual pair of tensor equations

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5890}
\begin{aligned}
\partial_i F^{ij} &= 0 \\
\epsilon^{ijkl} \partial_j F_{kl} &= 0
\end{aligned},
\end{equation}

or the Geometric Algebra equation
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5910}
\grad F = 0.
\end{dmath}

An aspect of differential forms that I found unintuitive, is that all physical quantities have to be expressed as forms, even when we have no pressing desire to integrate them.  It also seemed to me that it ought to be possible to express volume and area elements in parameterized spaces directly as wedge products.  For example, given a two parameter surface of all the points that can be traced out on \(\Bx(u, v)\), we can express the (oriented) area of a patch of that surface directly as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5930}
dA = \lr{ du \PD{u}{\Bx} } \wedge \lr{ dv \PD{v}{\Bx} }.
\end{dmath}

With such a capability is the abstract notion of a form really required?  Can we stick with the vector notation that we are comfortable with, perhaps just generalizing slightly?  How would something like Stokes theorem, a basic tool needed to tackle so many problems in electromagnetism, be expressed so that it acted on vectors directly?

An answer to this question was found in Denker's straight wire treatment \citep{DenkerWire}, which states that the geometric algebra formulation of Stokes theorem has the form

\begin{equation}\label{eqn:vector_integral_relations:stokesGA}
\int_S \grad \wedge F = \int_{\partial S} F.
\end{equation}

This looks simple enough, but there are some important details left out.  In particular the grades do not match, so there must be some sort of implied projection or dot product.  We also need to understand how to express the hypervolume and hypersurfaces when evaluating these integrals, especially when we want to use curvilinear coordinates.

If one restricts attention to the special case where the dimension of the integration volume also equaled the dimension of the vector space, so that the grade of the curl matches the grade of the space (i.e. integration of a two form \(\int d^2 \Bx \cdot \lr{\spacegrad \wedge \Bf}\) in a two dimensional space), then some of those important details are not difficult to work out.

To treat a more general case, such as the same two form \(\int d^2 \Bx \cdot (\spacegrad \wedge \Bf)\) in a space of dimension greater than two, we need to introduce the notion of tangent space.  That concept can also be found in differential forms, but can also be expressed directly in vector algebra.  Suppose, for example, that \(\Bx(u,v,w)\) parameterizes a subspace, the the tangent space at the point of evaluation is the space that is spanned by \(\setlr{ \PDi{u}{\Bx}, \PDi{v}{\Bx}, \PDi{w}{\Bx} }\).  Stokes theorem is expressed not in terms of the gradient \(\spacegrad\), but in terms of the projection of the gradient onto the tangent space.  This projection denoted by \(\boldpartial\) and called the vector derivative.  The concept of tangent space and and vector derivative are covered thoroughly in \citep{aMacdonaldVAGC}, which also introduces Stokes theorem as a special case of a more fundamental theorem for integration of geometric algebraic objects.

The objective of this chapter is to detail the Geometric Algebra form of Stokes theorem, and not the fundamental theorem of geometric calculus.  Specific aims include the generalization of Stokes theorem to higher dimensional spaces and non-Euclidean metrics and understanding how to properly deal with curvilinear coordinates.  An understanding of both non-Euclidean and higher dimenional spaces is required for
special relativity and electromagnetism. This generalization has the form

\input{calculus/stokesTheoremTheStatement.tex}

This dot product defines the oriented surface ``area'' elements associated with the ``volume'' element \( d^k \Bx \).  That area element is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1401}
d^{k-1} \Bx = \sum_i d^k \Bx \cdot \Bx^i.
\end{equation}

The \(i\)th contribution \( d^k \Bx \cdot \Bx^i \) to this area elements is evaluated with the associated parameter \( u^i \) held constant, which allows the right hand side integral of \eqnref{eqn:stokesTheoremGeometricAlgebra:2840} to be evaluated for each \( i\) independently.
This means the area element \(d^{k-1} \Bx \) and the blade \(F\) that it is dotted with in Stokes theorem, are both evaluated at the end points of integration variable \(u^i\) that has been integrated against.

Some work is required to make sense of these concepts and fully detail the meaning of all the terms in this statement of Stokes Theorem.
I will attempt to do so in a gradual fashion, providing a number of examples
such as that of \eqnref{eqn:stokesTheoremGeometricAlgebra:1760}, and \eqnref{eqn:stokesTheoremGeometricAlgebra:1820}, which
illustrate some of the relevant details.

Before we can get there, we need some notation for curvilinear coordinates, and need to define the reciprocal frame vectors \( \Bx^i \) used in the expansion of the vector derivative curl.

\section{Curvilinear coordinates}
%\section{Basic notation}

A finite vector space, not necessarily Euclidean, with basis \(\setlr{\Be_1, \Be_2, \cdots}\) will be assumed to be the generator of the geometric algebra.  A dual or reciprocal basis \(\setlr{\Be^1, \Be^2, \cdots}\) for this basis can be calculated, defined by the property

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:20}
\Be_i \cdot \Be^j = {\delta_i}^j.
\end{equation}

This is an Euclidean space when \(\Be_i = \Be^i, \forall i\).

%%% basic notation %%%%%%Implicit summation over repeated indices, typically over mixed upper and lower indices, will be assumed unless otherwise noted.
%%% basic notation %%%%%%For example, the components of a vector \(\Bx\) with respect to the standard or reciprocal bases, are
%%% basic notation %%%%%%
%%% basic notation %%%%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:40}
%%% basic notation %%%%%%\Bx = \Be_i x^i = \Be^j x_j.
%%% basic notation %%%%%%\end{equation}
%%% basic notation %%%%%%
%%% basic notation %%%%%%The coordinates of the vector follow by taking dot products
%%% basic notation %%%%%%
%%% basic notation %%%%%%\begin{subequations}
%%% basic notation %%%%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:60}
%%% basic notation %%%%%%\Bx \cdot \Be^j = \lr{ \Be_i x^i } \cdot \Be^j = x^i {\delta_i}^j = x^j
%%% basic notation %%%%%%\end{equation}
%%% basic notation %%%%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:80}
%%% basic notation %%%%%%\Bx \cdot \Be_j = \lr{ \Be^i x_i } \cdot \Be_j = x_i {\delta^i}_j = x_j
%%% basic notation %%%%%%\end{equation}
%%% basic notation %%%%%%\end{subequations}
%%% basic notation %%%%%%
%%% basic notation %%%%%%Similarly, a bivector \(F\) in coordinate representation has the form
%%% basic notation %%%%%%
%%% basic notation %%%%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1180}
%%% basic notation %%%%%%F = \inv{2} \Be^i \wedge \Be^j F_{ij} = \inv{2} \Be_i \wedge \Be_j F^{ij},
%%% basic notation %%%%%%\end{equation}
%%% basic notation %%%%%%
%%% basic notation %%%%%%where
%%% basic notation %%%%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1200}
%%% basic notation %%%%%%\begin{aligned}
%%% basic notation %%%%%%F_{ij} &= \lr{ F \cdot \Be_j } \cdot \Be_i \\
%%% basic notation %%%%%%F^{ij} &= \lr{ F \cdot \Be^j } \cdot \Be^i.
%%% basic notation %%%%%%\end{aligned}
%%% basic notation %%%%%%\end{equation}
%%% basic notation %%%%%%
%%% basic notation %%%
%%% basic notation %%%To select from a multivector \(A\) the grade \(k\) portion, say \(A_k\) we write
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1220}
%%% basic notation %%%A_k = \gpgrade{A}{k}.
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%The scalar portion of a multivector \(A\) will be written as
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1240}
%%% basic notation %%%\gpgrade{A}{0} \equiv \gpgradezero{A}.
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%The grade selection operators can be used to define the outer and inner products.  For blades \(U\), and \(V\) of grade \(r\) and \(s\) respectively, these are
%%% basic notation %%%
%%% basic notation %%%\begin{subequations}
%%% basic notation %%%\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:300}
%%% basic notation %%%\gpgrade{ U V }{\Abs{r + s}} \equiv U \wedge V
%%% basic notation %%%\end{dmath}
%%% basic notation %%%\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:780}
%%% basic notation %%%\gpgrade{ U V }{\Abs{r - s}} \equiv U \cdot V.
%%% basic notation %%%\end{dmath}
%%% basic notation %%%\end{subequations}
%%% basic notation %%%
%%% basic notation %%%Written out explicitly for odd grade blades \(A\) (vector, trivector, ...), and vector \(\Ba\) the dot and wedge products are respectively
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:800}
%%% basic notation %%%\begin{aligned}
%%% basic notation %%%\Ba \wedge A &= \inv{2} (\Ba A - A \Ba) \\
%%% basic notation %%%\Ba \cdot A &= \inv{2} (\Ba A + A \Ba).
%%% basic notation %%%\end{aligned}
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%Similarly for even grade blades these are
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:820}
%%% basic notation %%%\begin{aligned}
%%% basic notation %%%\Ba \wedge A &= \inv{2} (\Ba A + A \Ba) \\
%%% basic notation %%%\Ba \cdot A &= \inv{2} (\Ba A - A \Ba).
%%% basic notation %%%\end{aligned}
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%It will be useful to employ the cyclic scalar reordering identity for the scalar selection operator
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:920}
%%% basic notation %%%\gpgradezero{\Ba \Bb \Bc}
%%% basic notation %%%= \gpgradezero{\Bb \Bc \Ba}
%%% basic notation %%%= \gpgradezero{\Bc \Ba \Bb}.
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%For an \(N\) dimensional vector space, a product of \(N\) orthonormal (up to a sign) unit vectors is referred to as a pseudoscalar for the space, typically denoted by \(I\)
%%% basic notation %%%
%%% basic notation %%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5790}
%%% basic notation %%%I = \Be_1 \Be_2 \cdots \Be_N.
%%% basic notation %%%\end{equation}
%%% basic notation %%%
%%% basic notation %%%The pseudoscalar may commute or anticommute with other blades in the space.  We may also form a pseudoscalar for a subspace spanned by vectors \(\setlr{\Ba, \Bb, \cdots, \Bc}\) by unit scaling the wedge products of those vectors \(\Ba \wedge \Bb \wedge \cdots \wedge \Bc\).
%%% basic notation %%%
%\section{Curvilinear coordinates}

For our purposes a \textAndIndex{manifold} can be loosely defined as a parameterized surface.  For example, a 2D manifold can be considered a surface in an \(n\) dimensional vector space, parameterized by two variables

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1280}
\Bx = \Bx(a,b) = \Bx(u^1, u^2).
\end{equation}

Note that the indices here do not represent exponentiation.  We can construct a basis for the manifold as

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1300}
\Bx_i = \PD{u^i}{\Bx}.
\end{equation}

On the manifold we can calculate a \textAndIndex{reciprocal basis} \(\setlr{\Bx^i}\), defined by requiring, at each point on the surface

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1320}
\Bx^i \cdot \Bx_j = {\delta^i}_j.
\end{equation}

Associated implicitly with this basis is a curvilinear coordinate representation defined by the projection operation

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1340}
\Bx = x^i \Bx_i,
\end{equation}

(sums over mixed indices are implied).   These coordinates can be calculated by taking dot products with the \textAndIndex{reciprocal frame vectors}

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1360}
\Bx \cdot \Bx^i
= x^j \Bx_j \cdot \Bx^i
= x^j {\delta_j}^i
= x^i.
\end{dmath}

%Having used the same notation for coordinates with respect to the standard basis and its dual, we must rely on context to disambiguate the two.
In this document all coordinates are with respect to a specific \textAndIndex{curvilinear basis}, and not with respect to the \textAndIndex{standard basis} \(\setlr{\Be_i}\) or its \textAndIndex{dual basis} unless otherwise noted.

Similar to the usual notation for derivatives with respect to the standard basis coordinates we form a lower index partial derivative operator

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2900}
\PD{u^i}{} \equiv \partial_i,
\end{dmath}

so that when the complete vector space is spanned by \(\setlr{\Bx_i}\) the gradient has the curvilinear representation

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1380}
\spacegrad = \Bx^i \PD{u^i}{}.
\end{dmath}

%This can be motivated by noting that the directional derivative is defined by
%
%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1260}
%\Ba \cdot \spacegrad f(\Bx) = \lim_{t \rightarrow 0} \frac{f(\Bx + t \Ba) - f(\Bx)}{t}.
%\end{equation}
%%%
%%%the gradient \(\spacegrad\), in terms of the standard and dual bases is
%%%
%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:100}
%%%\spacegrad \equiv \Be^i \PD{x^i}{}.
%%%%\equiv \Be^i \partial_i,
%%%\end{equation}

When the basis \(\setlr{\Bx_i}\) does not span the space, the projection of the gradient onto the tangent space at the point of evaluation is
given by \eqnref{eqn:stokesTheoremGeometricAlgebra:1400}.

%It will be convient to write this sum over indices \(i\) with the short hand \(\PD{u^i}{} \equiv \partial_i\), or
%
%\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1740}
%\boldpartial = \Bx^i \partial_i.
%\end{dmath}

% redundant:
%See \citep{aMacdonaldVAGC} for a more complete discussion of the gradient and vector derivatives in curvilinear coordinates.

\section{Green's theorem}

Given a two parameter (\(u,v\)) surface parameterization, the curvilinear coordinate representation of a vector \(\Bf\) has the form

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1640}
\Bf = f_u \Bx^u + f_v \Bx^v + f_\perp \Bx^\perp.
\end{dmath}

We assume that the vector space is of dimension two or greater but otherwise unrestricted, and need not have an Euclidean basis.  Here \(f_\perp \Bx^\perp\) denotes the rejection of \(\Bf\) from the tangent space at the point of evaluation.  Green's theorem relates the integral around a closed curve to an ``area'' integral on that surface

\maketheorem{Green's Theorem}{thm:stokesTheoremGeometricAlgebra:1660}{
\index{Green's theorem}
\begin{equation*}
\ointctrclockwise \Bf \cdot d\Bl
=
\iint \lr{
-\PD{v}{f_u}
+\PD{u}{f_v}
}
du dv
\end{equation*}
}

Following the arguments used in \citep{schwartz1987pe} for Stokes theorem in three dimensions, we first evaluate the loop integral along the differential element of the surface at the point \(\Bx(u_0, v_0)\) evaluated over the range \((du, dv)\), as shown in the infinitesimal loop of \cref{fig:loopIntegralInfinitesimal:loopIntegralInfinitesimalFig1}.

\imageFigure{../../figures/gabook/loopIntegralInfinitesimalFig1}{Infinitesimal loop integral}{fig:loopIntegralInfinitesimal:loopIntegralInfinitesimalFig1}{0.2}

Over the infinitesimal area, the loop integral decomposes into

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1700}
\ointctrclockwise \Bf \cdot d\Bl
=
\int \Bf \cdot d\Bx_1
+\int \Bf \cdot d\Bx_2
+\int \Bf \cdot d\Bx_3
+\int \Bf \cdot d\Bx_4,
\end{dmath}

where the differentials along the curve are

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1600}
\begin{aligned}
d\Bx_1 &= \evalbar{ \PD{u}{\Bx} }{v = v_0} du \\
d\Bx_2 &= \evalbar{ \PD{v}{\Bx} }{u = u_0 + du} dv \\
d\Bx_3 &= -\evalbar{ \PD{u}{\Bx} }{v = v_0 + dv} du \\
d\Bx_4 &= -\evalbar{ \PD{v}{\Bx} }{u = u_0} dv.
\end{aligned}
\end{dmath}

It is assumed that the parameterization change \((du, dv)\) is small enough that this loop integral can be considered planar (regardless of the dimension of the vector space).  Making use of the fact that \(\Bx^\perp \cdot \Bx_\alpha = 0\) for \(\alpha \in \setlr{u,v}\), the loop integral is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1620}
\ointctrclockwise \Bf \cdot d\Bl
=
\int
\lr{
f_u \Bx^u + f_v \Bx^v + f_\perp \Bx^\perp
}
\cdot
\Bigl(
\Bx_u(u, v_0) du - \Bx_u(u, v_0 + dv) du
+\Bx_v(u_0 + du, v) dv - \Bx_v(u_0, v) dv
\Bigr)
=
\int
f_u(u, v_0) du - f_u(u, v_0 + dv) du
+
f_v(u_0 + du, v) dv - f_v(u_0, v) dv
\end{dmath}

With the distances being infinitesimal, these differences can be rewritten as partial differentials

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1860}
\ointctrclockwise \Bf \cdot d\Bl
=
\iint \lr{
-\PD{v}{f_u}
+\PD{u}{f_v}
}
du dv.
\end{dmath}

We can now sum over a larger area as in \cref{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}

\imageFigure{../../figures/gabook/loopIntegralInfinitesimalSumFig2}{Sum of infinitesimal loops}{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}{0.2}

All the opposing oriented loop elements cancel, so the integral around the complete boundary of the surface \(\Bx(u, v)\) is given by the \(u,v\) area integral of the partials difference.

We will see that Green's theorem is a special case of the Stokes theorem.  This observation will also provide a geometric interpretation of the right hand side area integral of \cref{thm:stokesTheoremGeometricAlgebra:1660}, and allow for a coordinate free representation.

\paragraph{Special case:}

An important special case of Green's theorem is for a Euclidean two dimensional space where the vector function is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1720}
\Bf = P \Be_1 + Q \Be_2.
\end{dmath}

Here Green's theorem takes the form

\boxedEquation{eqn:stokesTheoremGeometricAlgebra:1710}{
\ointctrclockwise P dx + Q dy
=
\iint \lr{
\PD{x}{Q}
-\PD{y}{P}
}
dx dy.
}

\section{Stokes theorem, two volume vector field}

Having examined the right hand side of \cref{thm:stokesTheoremGeometricAlgebra:1740} for the very simplest geometric object \(\Bf\), let's look at the right hand side, the area integral in more detail.  We restrict our attention for now to vectors \(\Bf\) still defined by \eqnref{eqn:stokesTheoremGeometricAlgebra:1640}.

First we need to assign a meaning to \(d^2 \Bx\).  By this, we mean the wedge products of the two differential elements.  With

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1780}
d\Bx_i = du^i \PD{u^i}{\Bx} = du^i \Bx_i,
\end{dmath}

that area element is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:1800}
d^2 \Bx
= d\Bx_1 \wedge d\Bx_2
= du^1 du^2 \Bx_1 \wedge \Bx_2.
\end{equation}

This is the oriented area element that lies in the \textAndIndex{tangent plane} at the point of evaluation, and has the magnitude of the area of that segment of the surface, as depicted in \cref{fig:loopIntegralAreaElements:loopIntegralAreaElementsFig3}.

\imageFigure{../../figures/gabook/loopIntegralAreaElementsFig3}{Oriented area element tiling of a surface}{fig:loopIntegralAreaElements:loopIntegralAreaElementsFig3}{0.3}

Observe that we have no requirement to introduce a normal to the surface to describe the direction of the plane.  The wedge product provides the information about the orientation of the place in the space, even when the vector space that our vector lies in has dimension greater than three.

Proceeding with the expansion of the dot product of the area element with the curl, using scalar selection
%\eqnref{eqn:stokesTheoremGeometricAlgebra:800}, \eqnref{eqn:stokesTheoremGeometricAlgebra:820}, and \eqnref{eqn:stokesTheoremGeometricAlgebra:920}, and a scalar selection operation, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1760}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\gpgradezero{
d^2 \Bx \lr{ \boldpartial \wedge \Bf }
}
=
\gpgradezero{
d^2 \Bx
\inv{2}
\lr{ \rboldpartial \Bf - \Bf \lboldpartial }
}
=
\inv{2}
\gpgradezero{
d^2 \Bx \lr{ \Bx^i \lr{ \partial_i \Bf} - \lr{\partial_i \Bf} \Bx^i }
}
=
\inv{2}
\gpgradezero{
\lr{ \partial_i \Bf } d^2 \Bx \,\Bx^i - \lr{ \partial_i \Bf } \Bx^i d^2 \Bx
}
=
\gpgradezero{
\lr{ \partial_i \Bf } \lr{ d^2 \Bx \cdot \Bx^i }
}
=
\partial_i \Bf \cdot
\lr{ d^2 \Bx \cdot \Bx^i }.
\end{dmath}

Let's proceed to expand the inner dot product

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1820}
d^2 \Bx \cdot \Bx^i
=
du^1 du^2
\lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i
=
du^1 du^2
\lr{
\Bx_2 \cdot \Bx^i \Bx_1
-\Bx_1 \cdot \Bx^i \Bx_2
}
=
du^1 du^2
\lr{
{\delta_2}^i \Bx_1
-{\delta_1}^i \Bx_2
}.
\end{dmath}

The complete curl term is thus

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1840}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
du^1 du^2
\lr{
\PD{u^2}{\Bf} \cdot \Bx_1
-\PD{u^1}{\Bf} \cdot \Bx_2
}
\end{dmath}

This almost has the form of \eqnref{eqn:stokesTheoremGeometricAlgebra:1860}, although that is not immediately obvious.  Working backwards, using the shorthand \(u = u^1, v = u^2\), we can show that this coordinate representation can be eliminated

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1900}
-du dv
\lr{
\PD{u}{f_v} -\PD{v}{f_u}
}
=
du dv
\lr{
\PD{v}{}\lr{\Bf \cdot \Bx_u}
-\PD{u}{}\lr{\Bf \cdot \Bx_v}
}
=
du dv
\lr{
\PD{v}{\Bf} \cdot \Bx_u
-\PD{u}{\Bf} \cdot \Bx_v
+
\Bf \cdot \lr{
\PD{v}{\Bx_u}
-\PD{u}{\Bx_v}
}
}
=
du dv
\lr{
\PD{v}{\Bf} \cdot \Bx_u
-\PD{u}{\Bf} \cdot \Bx_v
+
\Bf \cdot \lr{
\frac{\partial^2 \Bx}{\partial v \partial u}
-\frac{\partial^2 \Bx}{\partial u \partial v}
}
}
=
du dv
\lr{
\PD{v}{\Bf} \cdot \Bx_u
-\PD{u}{\Bf} \cdot \Bx_v
}
=
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
.
\end{dmath}

This relates the two parameter surface integral of the curl to the loop integral over its boundary

\boxedEquation{eqn:stokesTheoremGeometricAlgebra:1980}{
\int d^2 \Bx \cdot (\boldpartial \wedge \Bf) = \ointclockwise \Bf \cdot d\Bl.
}

This is the very simplest special case of Stokes theorem.   When written in the general form of Stokes \cref{thm:stokesTheoremGeometricAlgebra:1740}

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5770}
\int_A d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf}
=
\int_{\partial A} d^1 \Bx \cdot \Bf
=
\int_{\partial A} \lr{ d\Bx_1 - d\Bx_2 } \cdot \Bf,
\end{equation}

we must remember (the \(\partial A\) is to remind us of this) that it is implied that both the vector \(\Bf\) and the differential elements are evaluated on the boundaries of the integration ranges respectively.  A more exact statement is

\boxedEquation{eqn:stokesTheoremGeometricAlgebra:3620}{
\int_{\partial A} d^1 \Bx \cdot \Bf
%\ointclockwise \Bf \cdot d\Bl
=
\int
\evalbar{\Bf \cdot d\Bx_1}{\Delta u^2}
-\evalbar{\Bf \cdot d\Bx_2}{\Delta u^1}
=
\int
\evalbar{f_1}{\Delta u^2} du^1
-\evalbar{f_2}{\Delta u^1} du^2.
}

Expanded out in full this is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5810}
\int
\evalbar{\Bf \cdot d\Bx_1}{u^2(1)}
-\evalbar{\Bf \cdot d\Bx_1}{u^2(0)}
+\evalbar{\Bf \cdot d\Bx_2}{u^1(0)}
-\evalbar{\Bf \cdot d\Bx_2}{u^1(1)},
\end{equation}

which can be cross checked against \cref{fig:clockwiseLoopOnSurface:clockwiseLoopOnSurfaceFig12} to demonstrate that this specifies a clockwise orientation.  For the surface with oriented area \(d\Bx_1 \wedge d\Bx_2\), the clockwise loop is designated with line elements (1)-(4), we see that the contributions around this loop (in boxes) match \eqnref{eqn:stokesTheoremGeometricAlgebra:5810}.

\imageFigure{../../figures/gabook/clockwiseLoopOnSurfaceFig12}{Clockwise loop}{fig:clockwiseLoopOnSurface:clockwiseLoopOnSurfaceFig12}{0.3}

%\imageFigure{../../figures/gabook/cylindricalPolarParameterizationFig6}{Oriented polar parameterization loop}{fig:cylindricalPolarParameterization:cylindricalPolarParameterizationFig6}{0.15}

\makeexample{Green's theorem, a 2D Cartesian parameterization for a Euclidean space}{example:stokesTheoremGeometricAlgebra:2920}{

For a Cartesian 2D Euclidean parameterization of a vector field and the integration space, Stokes theorem should be equivalent to Green's theorem \eqnref{eqn:stokesTheoremGeometricAlgebra:1710}.  Let's expand both sides of \eqnref{eqn:stokesTheoremGeometricAlgebra:1980} independently to verify equality.  The parameterization is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2940}
\Bx(x, y) = x \Be_1 + y \Be_2.
\end{dmath}

Here the dual basis is the basis, and the projection onto the tangent space is just the gradient

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2960}
\boldpartial = \spacegrad
= \Be_1 \PD{x}{}
+ \Be_2 \PD{y}{}.
\end{equation}

The volume element is an area weighted pseudoscalar for the space

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2980}
d^2 \Bx = dx dy \PD{x}{\Bx} \wedge \PD{y}{\Bx} = dx dy \Be_1 \Be_2,
\end{equation}

and the curl of a vector \(\Bf = f_1 \Be_1 + f_2 \Be_2\) is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3000}
\boldpartial \wedge \Bf
=
\lr{
\Be_1 \PD{x}{}
+ \Be_2 \PD{y}{}
} \wedge
\lr{
f_1 \Be_1 + f_2 \Be_2
}
=
\Be_1 \Be_2
\lr{
\PD{x}{f_2}
-\PD{y}{f_1}
}.
\end{dmath}

So, the LHS of Stokes theorem takes the coordinate form

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3020}
\int d^2 \Bx \cdot (\boldpartial \wedge \Bf) =
\iint dx dy
\mathLabelBox{\gpgradezero{\Be_1 \Be_2 \Be_1 \Be_2}}{\(=-1\)}
\lr{
\PD{x}{f_2}
-\PD{y}{f_1}
}.
\end{dmath}

For the RHS, following \cref{fig:euclidean2Dloop:euclidean2DloopFig4}, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3040}
\ointclockwise \Bf \cdot d\Bx
=
f_2(x_0, y) dy
+
f_1(x, y_1) dx
-
f_2(x_1, y) dy
-
f_1(x, y_0) dx
=
\int dx \lr{
f_1(x, y_1)
-
f_1(x, y_0)
}
-
\int dy \lr{
f_2(x_1, y)
-
f_2(x_0, y)
}.
\end{dmath}

As expected, we can also obtain this by integrating \eqnref{eqn:stokesTheoremGeometricAlgebra:3020}.

\imageFigure{../../figures/gabook/euclidean2DloopFig4}{Euclidean 2D loop}{fig:euclidean2Dloop:euclidean2DloopFig4}{0.15}
}

\makeexample{Cylindrical parameterization}{example:stokesTheoremGeometricAlgebra:3060}{

Let's now consider a cylindrical parameterization of a 4D space with Euclidean metric \index{metric!Euclidean} \(++++\) or Minkowski metric \index{metric!Minkowski} \(+++-\).  For such a space let's do a brute force expansion of both sides of Stokes theorem to gain some confidence that all is well.

With \(\kappa = \Be_3 \Be_4\), such a space is conveniently parameterized as illustrated in \cref{fig:cylindricalPolarParameterization:cylindricalPolarParameterizationFig7} as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3080}
\Bx(\rho, \theta, h) = x \Be_1 + y \Be_2 + \rho \Be_3 e^{\kappa \theta}.
\end{dmath}

\imageFigure{../../figures/gabook/cylindricalPolarParameterizationFig7}{Cylindrical polar parameterization}{fig:cylindricalPolarParameterization:cylindricalPolarParameterizationFig7}{0.15}

%\imageFigure{../../figures/gabook/cylindricalPolarParameterizationFig5}{Cylindrical polar parameterization}{fig:cylindricalPolarParameterization:cylindricalPolarParameterizationFig5}{0.15}

Note that the Euclidean case where \(\lr{\Be_4}^2 = 1\) rejection of the non-axial components of \(\Bx\) expands to

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3100}
\lr{ \lr{ \Bx \wedge \Be_1 \wedge \Be_2} \cdot \Be^2 } \cdot \Be^1 =
\rho \lr{ \Be_3 \cos\theta + \Be_4 \sin \theta },
\end{dmath}

whereas for the Minkowski case where \(\lr{\Be_4}^2 = -1\) the expansion is hyperbolic

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3120}
\lr{ \lr{ \Bx \wedge \Be_1 \wedge \Be_2} \cdot \Be^2 } \cdot \Be^1 =
\rho \lr{ \Be_3 \cosh\theta + \Be_4 \sinh \theta }.
\end{dmath}

Within such a space consider the surface along \(x = c, y = d\), for which the vectors are parameterized by

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3140}
\Bx(\rho, \theta) = c \Be_1 + d \Be_2 + \rho \Be_3 e^{\kappa \theta}.
\end{dmath}

The tangent space unit vectors are

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3160}
\Bx_\rho
= \PD{\rho}{\Bx} = \Be_3 e^{\kappa \theta},
\end{dmath}

and
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3180}
\Bx_\theta
= \PD{\theta}{\Bx}
= \rho \Be_3 \Be_3 \Be_4 e^{\kappa \theta}
= \rho \Be_4 e^{\kappa \theta}.
\end{dmath}

Observe that both of these vectors have their origin at the point of evaluation, and aren't relative to the absolute origin used to parameterize the complete space. % projective geometry?

We wish to compute the volume element for the tangent plane.  Noting that \(\Be_3\) and \(\Be_4\) both anticommute with \(\kappa\) we have for \(\Ba \in \Span \setlr{\Be_3, \Be_4}\)

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3380}
\Ba e^{\kappa \theta} = e^{-\kappa \theta} \Ba,
\end{dmath}

so
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3400}
\Bx_\theta \wedge \Bx_\rho
=
\gpgradetwo{
\Be_3 e^{\kappa \theta} \rho \Be_4 e^{\kappa \theta}
}
=
\rho \gpgradetwo{
\Be_3 e^{\kappa \theta} e^{-\kappa \theta} \Be_4
}
=
\rho \Be_3 \Be_4.
\end{dmath}

The tangent space volume element is thus

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3420}
d^2 \Bx = \rho d\rho d\theta \Be_3 \Be_4.
\end{dmath}

With the tangent plane vectors both perpendicular we don't need the general \cref{thm:stokesTheoremGeometricAlgebra:3200} to compute the reciprocal basis, but can do so by inspection

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3540}
\Bx^\rho = e^{-\kappa \theta} \Be^3,
\end{equation}

and
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3560}
\Bx^\theta = e^{-\kappa \theta} \Be^4 \inv{\rho}.
\end{equation}

Observe that the latter depends on the metric signature.

The vector derivative, the projection of the gradient on the tangent space, is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3580}
\boldpartial
=
\Bx^\rho \PD{\rho}{}
+\Bx^\theta \PD{\theta}{}
=
e^{-\kappa \theta}
\lr{
\Be^3 \partial_\rho
+ \frac{\Be^4}{\rho} \partial_\theta
}.
\end{dmath}

From this we see that acting with the vector derivative on a scalar radial only dependent function \(f(\rho)\) is a vector function that has a radial direction, whereas the action of the vector derivative on an azimuthal only dependent function \(g(\theta)\) is a vector function that has only an azimuthal direction.  The interpretation of the geometric product action of the vector derivative on a vector function is not as simple since the product will be a multivector.

Expanding the curl in coordinates is messier, but yields in the end when tackled with sufficient care

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3500}
\boldpartial \wedge \Bf
=
\gpgradetwo{
e^{-\kappa \theta}
\lr{
   e^3 \partial_\rho + \frac{e^4}{\rho} \partial_\theta
}
\lr{
   \cancel{e_1 x}
 + \cancel{e_2 y}
 + e_3 e^{\kappa \theta } f_\rho
 + \frac{e^4}{\rho} e^{\kappa \theta } f_\theta
}
}
=
\cancel{\gpgradetwo{
e^{-\kappa \theta}
   e^3 \partial_\rho
\lr{
   e_3 e^{\kappa \theta } f_\rho
}
}
}
+
\gpgradetwo{
\cancel{e^{-\kappa \theta}}
   e^3 \partial_\rho
\lr{
   \frac{e^4}{\rho} \cancel{e^{\kappa \theta }} f_\theta
}
}
+
\gpgradetwo{
e^{-\kappa \theta}
\frac{e^4}{\rho} \partial_\theta
\lr{
   e_3 e^{\kappa \theta } f_\rho
}
}
+
\gpgradetwo{
e^{-\kappa \theta}
\frac{e^4}{\rho} \partial_\theta
\lr{
   \frac{e^4}{\rho} e^{\kappa \theta } f_\theta
}
}
=
\Be^3
\Be^4
\lr{
-\frac{f_\theta}{\rho^2} + \inv{\rho} \partial_\rho f_\theta
- \inv{\rho} \partial_\theta f_\rho
}
+ \inv{\rho^2}
\gpgradetwo{
e^{-\kappa \theta} \lr{\Be^4}^2
\lr{
\Be_3 \Be_4 f_\theta
+ \cancel{\partial_\theta f_\theta}
}
e^{\kappa \theta}
}
=
\Be^3
\Be^4
\lr{
-\frac{f_\theta}{\rho^2} + \inv{\rho} \partial_\rho f_\theta
- \inv{\rho} \partial_\theta f_\rho
}
+ \inv{\rho^2}
\gpgradetwo{
\cancel{e^{-\kappa \theta} }
\Be_3 \Be^4 f_\theta
\cancel{e^{\kappa \theta}}
}
=
\frac{\Be^3
\Be^4
}{\rho}
\lr{
\partial_\rho f_\theta
- \partial_\theta f_\rho
}.
\end{dmath}

After all this reduction, we can now state in coordinates the LHS of Stokes theorem explicitly

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3600}
\int d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\int \rho d\rho d\theta
\gpgradezero{
\Be_3 \Be_4
\Be^3 \Be^4
}
\inv{\rho}
\lr{
\partial_\rho f_\theta
- \partial_\theta f_\rho
}
=
\int d\rho d\theta
\lr{
\partial_\theta f_\rho
-\partial_\rho f_\theta
}
=
\int d\rho \evalbar{f_\rho}{\Delta \theta}
-
\int d\theta
\evalbar{f_\theta}{\Delta \rho}.
\end{dmath}

Now compare this to the direct evaluation of the loop integral portion of Stokes theorem.  Expressing this using \eqnref{eqn:stokesTheoremGeometricAlgebra:3620}, we have the same result

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3640}
\int d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\int
\evalbar{f_\rho}{\Delta \theta} d\rho
-\evalbar{f_\theta}{\Delta \rho} d\theta
\end{equation}

This example highlights some of the power of Stokes theorem, since the reduction of the volume element differential form was seen to be quite a chore (and easy to make mistakes doing.)
}

\makeexample{Composition of boost and rotation}{example:stokesTheoremGeometricAlgebra:4230}{

Working in a \(\bigwedge^{1,3}\) space with basis \(\setlr{\gamma_0, \gamma_1, \gamma_2, \gamma_3}\) where \(\lr{\gamma_0}^2 = 1\) and \(\lr{\gamma_k}^2 = -1, k \in \setlr{1,2,3}\), an active composition of boost and rotation has the form

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4250}
\begin{aligned}
\Bx' &= e^{i\alpha/2} \Bx_0 e^{-i\alpha/2} \\
\Bx'' &= e^{-j\theta/2} \Bx' e^{j\theta/2}
\end{aligned},
\end{equation}

where \(i\) is a bivector of a timelike unit vector and perpendicular spacelike unit vector, and \(j\) is a bivector of two perpendicular spacelike unit vectors.  For example, \(i = \gamma_0 \gamma_1\) and \(j = \gamma_1 \gamma_2\).  For such \(i,j\) the respective Lorentz transformation matrices are

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4270}
{
\begin{bmatrix}
x^0 \\
x^1 \\
x^2 \\
x^3
\end{bmatrix}
}'
=
\begin{bmatrix}
\cosh\alpha & -\sinh\alpha & 0 & 0 \\
-\sinh\alpha & \cosh\alpha & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x^0 \\
x^1 \\
x^2 \\
x^3
\end{bmatrix},
\end{equation}

and

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4290}
{
\begin{bmatrix}
x^0 \\
x^1 \\
x^2 \\
x^3
\end{bmatrix}
}''
=
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & \cos\theta & \sin\theta & 0  \\
0 & -\sin\theta & \cos\theta & 0  \\
0 & 0 & 0 & 1
\end{bmatrix}
{
\begin{bmatrix}
x^0 \\
x^1 \\
x^2 \\
x^3
\end{bmatrix}
}'.
\end{equation}

Let's calculate the tangent space vectors for this parameterization, assuming that the particle is at an initial spacetime position of \(\Bx_0\).  That is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4310}
\Bx =
e^{-j\theta/2}
e^{i\alpha/2}
\Bx_0
e^{-i\alpha/2}
e^{j\theta/2}.
\end{equation}

To calculate the tangent space vectors for this subspace we note that

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4330}
\PD{\alpha}{\Bx'} = \frac{i}{2} \Bx_0 - \Bx_0 \frac{i}{2} = i \cdot \Bx_0,
\end{equation}

and
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4350}
\PD{\theta}{\Bx''} = -\frac{j}{2} \Bx' + \Bx' \frac{j}{2} = \Bx' \cdot j.
\end{equation}

The tangent space vectors are therefore

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4370}
\begin{aligned}
\Bx_\alpha &=
e^{-j\theta/2}
\lr{ i \cdot \Bx_0 }
e^{j\theta/2} \\
\Bx_\theta &=
\lr{
e^{i\alpha/2}
\Bx_0
e^{-i\alpha/2}
} \cdot j.
\end{aligned}
\end{equation}

Continuing a specific example where \(i = \gamma_0\gamma_1, j = \gamma_1 \gamma_2\) let's also pick \(\Bx_0 = \gamma_0\), the spacetime position of a particle at the origin of a frame at that frame's \(c t = 1\).  The tangent space vectors for the subspace parameterized by this transformation and this initial position is then reduced to

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4390}
\Bx_\alpha = -\gamma_1 e^{j \theta} = \gamma_1 \sin\theta + \gamma_2 \cos\theta,
\end{dmath}

and
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4410}
\Bx_\theta
= \lr{ \gamma_0 e^{-i \alpha} } \cdot j
= \lr{ \gamma_0\lr{ \cosh\alpha - \gamma_0 \gamma_1 \sinh\alpha }} \cdot \lr{ \gamma_1 \gamma_2}
=
\gpgradeone{ \lr{ \gamma_0 \cosh\alpha - \gamma_1 \sinh\alpha } \gamma_1 \gamma_2 }
= \gamma_2 \sinh\alpha.
\end{dmath}

By inspection the dual basis for this parameterization is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4430}
\begin{aligned}
\Bx^\alpha &= \gamma_1 e^{j \theta} \\
\Bx^\theta &= \frac{\gamma^2}{\sinh\alpha}
\end{aligned}
\end{equation}

So, Stokes theorem, applied to a spacetime vector \(\Bf\), for this subspace is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4450}
\begin{aligned}
\int d\alpha d\theta \sinh\alpha \sin\theta
&
\lr{ \gamma_1 \gamma_2 } \cdot
\lr{
\lr{
\gamma_1 e^{j \theta} \partial_\alpha
+ \frac{\gamma^2}{\sinh\alpha} \partial_\theta
}
\wedge \Bf
} \\
&=
\int d\alpha \evalrange{
\Bf \cdot \biglr{\gamma^1 e^{j \theta}}
}{\theta_0}{\theta_1}
-
\int d\theta \evalrange{
\Bf \cdot
\biglr{ \gamma_2
\sinh\alpha
}
}{\alpha_0}{\alpha_1}.
\end{aligned}
\end{equation}

Since the point is to avoid the curl integral, we did not actually have to state it explicitly, nor was there any actual need to calculate the dual basis.
}

\makeexample{Dual representation in three dimensions}{example:stokesTheoremGeometricAlgebra:3660}{

It's clear that there is a projective nature to the differential form \(d^2 \Bx \cdot \lr{\boldpartial \wedge \Bf}\).  This projective nature allows us, in three dimensions, to re-express Stokes theorem using the gradient instead of the vector derivative, and to utilize the cross product and a normal direction to the plane.

When we parameterize a normal direction to the tangent space, so that for a 2D tangent space spanned by curvilinear coordinates \(\Bx_1\) and \(\Bx_2\) the vector \(\Bx^3\) is normal to both, we can write our vector as

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3700}
\Bf = f_1 \Bx^1 + f_2 \Bx^2 + f_3 \Bx^3,
\end{equation}

and express the orientation of the tangent space area element in terms of a pseudoscalar that includes this normal direction

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3680}
\Bx_1 \wedge \Bx_2
=
\Bx^3 \cdot \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
=
\Bx^3 \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }.
\end{equation}

Inserting this into an expansion of the curl form we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3720}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
du^1 du^2 \gpgradezero{
\Bx^3 \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
\lr{
\lr{
\sum_{i=1,2} x^i \partial_i
}
\wedge
\Bf
}
}
=
du^1 du^2
\Bx^3 \cdot
\lr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
\cdot \lr{\spacegrad \wedge \Bf}
-
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
\cdot \lr{\Bx^3 \partial_3 \wedge \Bf}
}.
\end{dmath}

Observe that this last term, the contribution of the component of the gradient perpendicular to the tangent space, has no \(\Bx_3\) components

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3740}
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
\cdot \lr{\Bx^3 \partial_3 \wedge \Bf}
=
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
\cdot \lr{\Bx^3 \wedge \partial_3 \Bf}
=
\lr{
   \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \Bx^3
}
\cdot \partial_3 \Bf
=
\lr { \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
=
\Bx_1
\lr{ \Bx_2 \cdot \partial_3 \Bf }
-
\Bx_2
\lr{ \Bx_1 \cdot \partial_3 \Bf },
\end{dmath}

leaving
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3760}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
du^1 du^2 \Bx^3 \cdot
\lr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \lr{ \spacegrad \wedge \Bf}
}.
\end{dmath}

Now scale the normal vector and its dual to have unit norm as follows

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3780}
\begin{aligned}
\Bx^3 &= \alpha \xcap^3 \\
\Bx_3 &= \inv{\alpha} \xcap_3,
\end{aligned}
\end{equation}

so that for \(\beta > 0\), the volume element can be

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3860}
\Bx_1 \wedge \Bx_2 \wedge \xcap_3 = \beta I.
\end{dmath}

This scaling choice is illustrated in \cref{fig:outwardsNormal:outwardsNormalFig8}, and represents the ``outwards'' normal.  With such a scaling choice we have

\imageFigure{../../figures/gabook/outwardsNormalFig8}{Outwards normal}{fig:outwardsNormal:outwardsNormalFig8}{0.15}

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3800}
\beta du^1 du^2 = dA,
\end{dmath}

and almost have the desired cross product representation

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3820}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
dA \xcap^3 \cdot \lr{ I \cdot \lr{\spacegrad \wedge \Bf} }
=
dA \xcap^3 \cdot \lr{ I \lr{\spacegrad \wedge \Bf} }.
\end{dmath}

With the duality identity \(\Ba \wedge \Bb = I \lr{\Ba \cross \Bb}\), we have the traditional 3D representation of Stokes theorem

\boxedEquation{eqn:stokesTheoremGeometricAlgebra:3840}{
\int d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
-
\int
dA \xcap^3 \cdot \lr{\spacegrad \cross \Bf}
= \ointclockwise \Bf \cdot d\Bl.
}

Note that the orientation of the loop integral in the traditional statement of the 3D Stokes theorem is counterclockwise instead of clockwise, as written here.
}

\section{Stokes theorem, three variable volume element parameterization}

Let's now proceed to evaluate the area elements defined by \eqnref{eqn:stokesTheoremGeometricAlgebra:2840} for a three variable parameterization, and a vector blade \(\Bf\)

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1940}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\lr{ d^3 \Bx \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
 \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{
\lr{ \Bx_1 \wedge \Bx_2 } {\delta_3}^i
-\lr{ \Bx_1 \wedge \Bx_3 } {\delta_2}^i
+\lr{ \Bx_2 \wedge \Bx_3 } {\delta_1}^i
} \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{
\lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
-\lr{ \Bx_1 \wedge \Bx_3 } \cdot \partial_2 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 \Bf
}.
\end{dmath}

It should not be surprising that this has the structure found in the theory of differential forms.  Using the differentials for each of the parameterization ``directions'', we can write this dot product expansion as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2880}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
 du^3 \lr{ d\Bx_1 \wedge d\Bx_2 } \cdot \partial_3 \Bf
-du^2 \lr{ d\Bx_1 \wedge d\Bx_3 } \cdot \partial_2 \Bf
+du^1 \lr{ d\Bx_2 \wedge d\Bx_3 } \cdot \partial_1 \Bf
.
\end{dmath}

Observe that the sign changes with each element of \(d\Bx_1 \wedge d\Bx_2 \wedge d\Bx_3\) that is skipped.  In differential forms, the wedge product composition of 1-forms \index{1-form} is an abstract quantity.  Here the differentials are just vectors, and their wedge product represents an oriented volume element.  This interpretation is likely available in the theory of differential forms too, but is arguably less obvious.

\makedigression{
As was the case with the loop integral, we expect that the coordinate representation has a representation that can be expressed as a number of antisymmetric terms.  A bit of experimentation shows that such a sum, after dropping the parameter space volume element factor, is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:1960}
\Bx_1 \lr{ -\partial_2 f_3 + \partial_3 f_2 }
+\Bx_2 \lr{ -\partial_3 f_1 + \partial_1 f_3 }
+\Bx_3 \lr{ -\partial_1 f_2 + \partial_2 f_1 }
=
\Bx_1 \lr{ -\partial_2 \Bf \cdot \Bx_3 + \partial_3 \Bf \cdot \Bx_2 }
+\Bx_2 \lr{ -\partial_3 \Bf \cdot \Bx_1 + \partial_1 \Bf \cdot \Bx_3 }
+\Bx_3 \lr{ -\partial_1 \Bf \cdot \Bx_2 + \partial_2 \Bf \cdot \Bx_1 }
=
\lr{ \Bx_1 \partial_3 \Bf \cdot \Bx_2 -\Bx_2 \partial_3 \Bf \cdot \Bx_1 }
+\lr{ \Bx_3 \partial_2 \Bf \cdot \Bx_1 -\Bx_1 \partial_2 \Bf \cdot \Bx_3 }
+\lr{ \Bx_2 \partial_1 \Bf \cdot \Bx_3 -\Bx_3 \partial_1 \Bf \cdot \Bx_2 }
=
 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
+\lr{ \Bx_3 \wedge \Bx_1 } \cdot \partial_2 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 \Bf.
\end{dmath}
}

To proceed with the integration, we must again consider an infinitesimal volume element, for which the partial can be evaluated as the difference of the endpoints, with all else held constant.  For this three variable parameterization, say, \((u,v,w)\), let's delimit such an infinitesimal volume element by the parameterization ranges \([u_0,u_0 + du]\), \([v_0,v_0 + dv]\), \([w_0,w_0 + dw]\).  The integral is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2000}
\begin{aligned}
\int_{u = u_0}^{u_0 + du}
\int_{v = v_0}^{v_0 + dv}
\int_{w = w_0}^{w_0 + dw}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
&=
\int_{u = u_0}^{u_0 + du}
du
\int_{v = v_0}^{v_0 + dv}
dv
\evalrange{ \biglr{ \lr{ \Bx_u \wedge \Bx_v } \cdot \Bf } }{w = w_0}{w_0 + dw} \\
&-
\int_{u = u_0}^{u_0 + du}
du
\int_{w = w_0}^{w_0 + dw}
dw
\evalrange{\biglr{ \lr{ \Bx_u \wedge \Bx_w } \cdot \Bf } }{v = v_0}{v_0 + dv} \\
&+
\int_{v = v_0}^{v_0 + dv}
dv
\int_{w = w_0}^{w_0 + dw}
dw
\evalrange{
\biglr{ \lr{ \Bx_v \wedge \Bx_w } \cdot \Bf } }{u = u_0}{u_0 + du}
.
\end{aligned}
\end{equation}

Extending this over the ranges \([u_0,u_0 + \Delta u]\), \([v_0,v_0 + \Delta v]\), \([w_0,w_0 + \Delta w]\), we have proved Stokes \cref{thm:stokesTheoremGeometricAlgebra:1740} for vectors and a three parameter volume element, provided we have a surface element of the form

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2020}
d^2 \Bx =
\evalrange{ \biglr{d\Bx_u \wedge d\Bx_v } }{w = w_0}{w_1}
-
\evalrange{ \biglr{d\Bx_u \wedge d\Bx_w } }{v = v_0}{v_1}
+
\evalrange{ \biglr{d\Bx_v \wedge \Bx_w } }{ u = u_0 }{u_1},
\end{dmath}

where the evaluation of the dot products with \(\Bf\) are also evaluated at the same points.

\makeexample{Euclidean spherical polar parameterization of 3D subspace}{example:stokesTheoremGeometricAlgebra:3880}{

\index{coordinate!spherical}
Consider an Euclidean space where a 3D subspace is parameterized using spherical coordinates, as in

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3900}
\Bx(x, \rho, \theta, \phi) =
\Be_1 x + \Be_4 \rho \exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta}
=
\lr{x, \rho \sin\theta \cos\phi, \rho \sin\theta \sin\phi, \rho \cos\theta}.
\end{equation}

The tangent space basis for the subspace situated at some fixed \(x = x_0\), is easy to calculate, and is found to be

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5270}
\begin{aligned}
\Bx_\rho
&= \lr{0, \sin\theta \cos\phi, \sin\theta \sin\phi, \cos\theta}
 =
\Be_4 \exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta} \\
\Bx_\theta
&=
\rho
\lr{0,  \cos\theta \cos\phi,  \cos\theta \sin\phi, - \sin\theta}
=
\rho \Be_2 e^{\Be_2 \Be_3 \phi}
\exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta } \\
\Bx_\phi
&=
\rho
\lr{0, -\sin\theta \sin\phi,  \sin\theta \cos\phi, 0}
=
\rho \sin\theta \Be_3 e^{\Be_2 \Be_3 \phi}.
\end{aligned}
\end{equation}

While we can use the general relation of \cref{thm:stokesTheoremGeometricAlgebra:4950} to compute the reciprocal basis.  That is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3940}
\Ba^\conj =
\lr{ \Bb \wedge \Bc } \inv{\Ba \wedge \Bb \wedge \Bc }.
\end{equation}

However, a naive attempt at applying this without algebraic software is a route that requires a lot of care, and is easy to make mistakes doing.  In this case it is really not necessary since the tangent space basis only requires scaling to orthonormalize, satisfying for \(i,j \in \setlr{\rho, \theta, \phi}\)

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3960}
\Bx_i \cdot \Bx_j =
\begin{bmatrix}
 1 & 0 & 0 \\
 0 & \rho^2 & 0 \\
 0 & 0 & \rho^2 \sin^2 \theta
\end{bmatrix}.
\end{equation}

This allows us to read off the dual basis for the tangent volume by inspection

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5290}
\begin{aligned}
\Bx^\rho
&=
\Be_4 \exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta} \\
\Bx^\theta
&=
\inv{\rho} \Be_2 e^{\Be_2 \Be_3 \phi}
\exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta } \\
\Bx^\phi
&=
\inv{\rho \sin\theta} \Be_3 e^{\Be_2 \Be_3 \phi}.
\end{aligned}
\end{equation}

Should we wish to explicitly calculate the curl on the tangent space, we would need these.  The area and volume elements are also messy to calculate manually.  This expansion can be found in the \textAndIndex{Mathematica} notebook \nbref{sphericalSurfaceAndVolumeElements.nb}, and is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3980}
\begin{aligned}
\Bx_\theta \wedge \Bx_\phi &=
\rho^2 \sin\theta \left( \Be_4 \Be_2 \sin\theta \sin\phi + \Be_2 \Be_3 \cos\theta + \Be_3 \Be_4 \sin\theta \cos\phi \right) \\
\Bx_\phi \wedge \Bx_\rho &=
\rho \sin\theta \left(
-\Be_2 \Be_3 \sin\theta
-\Be_2 \Be_4 \cos\theta \sin\phi
+
\Be_3 \Be_4
\cos\theta \cos\phi
\right) \\
\Bx_\rho \wedge \Bx_\theta &= -\Be_4 \rho \left(
\Be_2
\cos\phi
+
\Be_3
\sin\phi
\right) \\
\Bx_\rho \wedge \Bx_\theta \wedge \Bx_\phi &= \Be_2 \Be_3 \Be_4 \rho^2 \sin\theta
\end{aligned}
\end{equation}

Those area elements have a Geometric Algebra factorization that are perhaps useful

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:3990}
\begin{aligned}
\Bx_\theta \wedge \Bx_\phi &=
-\rho^2 \sin\theta \Be_2 \Be_3 \exp\lr{
-\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta
} \\
\Bx_\phi \wedge \Bx_\rho &=
\rho \sin\theta \Be_3 \Be_4
e^{\Be_2 \Be_3 \phi}
\exp\lr{
\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \theta
} \\
\Bx_\rho \wedge \Bx_\theta &= -
\rho
\Be_4 \Be_2
e^{\Be_2 \Be_3 \phi}
\end{aligned}.
\end{equation}

One of the beauties of Stokes theorem is that we don't actually have to calculate the \textAndIndex{dual basis} on the tangent space to proceed with the integration.  For that calculation above, where we had a normal tangent basis, I still used software was used as an aid, so it is clear that this can generally get pretty messy.

To apply Stokes theorem to a vector field we can use \eqnref{eqn:stokesTheoremGeometricAlgebra:2020} to write down the integral directly

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4010}
\int_V d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\int_{\partial V} d^2 \Bx \cdot \Bf
=
\int
 \evalrange{ \lr{ \Bx_\theta \wedge \Bx_\phi } \cdot \Bf }{\rho = \rho_0}{\rho_1} d\theta d\phi
+
\int
\evalrange{ \lr{ \Bx_\phi \wedge \Bx_\rho } \cdot \Bf }{\theta = \theta_0}{\theta_1}  d\phi d\rho
+
\int
\evalrange{ \lr{ \Bx_\rho \wedge \Bx_\theta } \cdot \Bf }{\phi = \phi_0}{\phi_1}  d\rho d\theta.
\end{dmath}

Observe that \eqnref{eqn:stokesTheoremGeometricAlgebra:4010} is a vector valued integral that expands to

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4030}
\int
 \evalrange{ \lr{ \Bx_\theta f_\phi - \Bx_\phi f_\theta } }{\rho = \rho_0}{\rho_1} d\theta d\phi
+
\int
 \evalrange{ \lr{ \Bx_\phi f_\rho - \Bx_\rho f_\phi } }{\theta = \theta_0}{\theta_1} d\phi d\rho
+
\int
 \evalrange{ \lr{ \Bx_\rho f_\theta - \Bx_\theta f_\rho } }{\phi = \phi_0}{\phi_1} d\rho d\theta.
\end{equation}

This could easily be a difficult integral to evaluate since the vectors \(\Bx_i\) evaluated at the endpoints are still functions of two parameters.  An easier integral would result from the application of Stokes theorem to a bivector valued field, say \(B\), for which we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4050}
\int_V d^3 \Bx \cdot \lr{ \boldpartial \wedge B }
=
\int_{\partial V} d^2 \Bx \cdot B
=
\int
 \evalrange{ \lr{ \Bx_\theta \wedge \Bx_\phi } \cdot B }{\rho = \rho_0}{\rho_1} d\theta d\phi
+
\int
\evalrange{ \lr{ \Bx_\phi \wedge \Bx_\rho } \cdot B }{\theta = \theta_0}{\theta_1}  d\phi d\rho
+
\int
\evalrange{ \lr{ \Bx_\rho \wedge \Bx_\theta } \cdot B }{\phi = \phi_0}{\phi_1}  d\rho d\theta
=
\int
 \evalrange{ B_{\phi \theta} }{\rho = \rho_0}{\rho_1} d\theta d\phi
+
\int
\evalrange{ B_{\rho \phi} }{\theta = \theta_0}{\theta_1}  d\phi d\rho
+
\int
\evalrange{ B_{\theta \rho} }{\phi = \phi_0}{\phi_1}  d\rho d\theta.
\end{dmath}

There is a geometric interpretation to these oriented area integrals, especially when written out explicitly in terms of the differentials along the parameterization directions.  Pulling out a sign explicitly to match the geometry (as we had to also do for the line integrals in the two parameter volume element case), we can write this as

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4070}
\int_{\partial V} d^2 \Bx \cdot B
=
-\int
 \evalrange{ \lr{ d\Bx_\phi \wedge d\Bx_\theta } \cdot B }{\rho = \rho_0}{\rho_1}
-
\int
\evalrange{ \lr{ d\Bx_\rho \wedge d\Bx_\phi } \cdot B }{\theta = \theta_0}{\theta_1}
-
\int
\evalrange{ \lr{ d\Bx_\theta \wedge d\Bx_\rho } \cdot B }{\phi = \phi_0}{\phi_1}.
\end{equation}

When written out in this differential form, each of the respective area elements is an oriented area along one of the faces of the parameterization volume, much like the line integral that results from a two parameter volume curl integral.  This is visualized in \cref{fig:sphereicalParameterizationBoundaryFaces:sphereicalParameterizationBoundaryFacesFig9}.  In this figure, faces (1) and (3) are ``top faces'', those with signs matching the tops of the evaluation ranges \eqnref{eqn:stokesTheoremGeometricAlgebra:4070}, whereas face (2) is a bottom face with a sign that is correspondingly reversed.

\imageFigure{../../figures/gabook/sphereicalParameterizationBoundaryFacesFig9}{Boundary faces of a spherical parameterization region}{fig:sphereicalParameterizationBoundaryFaces:sphereicalParameterizationBoundaryFacesFig9}{0.25}
}
%FIXME: figure titled 'Oriented surface of a three parameter subspace' in older doc looks nicer.

\makeexample{Minkowski hyperbolic-spherical polar parameterization of 3D subspace}{example:stokesTheoremGeometricAlgebra:3920}{

Working with a three parameter volume element in a \textAndIndex{Minkowski space} does not change much.  For example in a 4D space with \(\lr{\Be_4}^2 = -1\), we can employ a hyperbolic-spherical parameterization similar to that used above for the 4D Euclidean space

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4090}
\Bx(x, \rho, \alpha, \phi)
=
\setlr{x, \rho \sinh \alpha \cos\phi, \rho \sinh \alpha \sin\phi, \rho \cosh \alpha}
=
\Be_1 x + \Be_4 \rho \exp\lr{ \Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha }.
\end{equation}

This has tangent space basis elements

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4110}
\begin{aligned}
\Bx_\rho &= \sinh\alpha \lr{ \cos\phi \Be_2 + \sin\phi \Be_3 } + \cosh\alpha \Be_4 =
\Be_4 \exp\lr{\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha} \\
\Bx_\alpha &=
\rho \cosh\alpha \lr{ \cos\phi \Be_2 + \sin\phi \Be_3} + \rho \sinh\alpha \Be_4
=
\rho \Be_2 e^{\Be_2 \Be_3 \phi} \exp\lr{-\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha} \\
\Bx_\phi &=
\rho \sinh\alpha \lr{ \Be_3 \cos\phi - \Be_2 \sin\phi} = \rho\sinh\alpha \Be_3 e^{\Be_2 \Be_3 \phi}.
\end{aligned}
\end{equation}

This is a normal basis, but again not orthonormal.  Specifically, for \(i,j \in \setlr{\rho, \theta, \phi}\) we have
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4130}
\Bx_i \cdot \Bx_j =
\begin{bmatrix}
-1 & 0 & 0 \\
 0 & \rho^2 & 0 \\
 0 & 0 & \rho^2 \sinh^2 \alpha
\end{bmatrix},
\end{equation}

where we see that the radial vector \(\Bx_\rho\) is timelike.  We can form the dual basis again by inspection
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4150}
\begin{aligned}
\Bx_\rho &= -\Be_4 \exp\lr{\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha} \\
\Bx_\alpha &= \inv{\rho} \Be_2 e^{\Be_2 \Be_3 \phi} \exp\lr{-\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha} \\
\Bx_\phi &= \inv{\rho\sinh\alpha} \Be_3 e^{\Be_2 \Be_3 \phi}.
\end{aligned}
\end{equation}

The area elements are

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4190}
\begin{aligned}
\Bx_\alpha \wedge \Bx_\phi &=
\rho^2 \sinh\alpha \left(-\Be_4 \Be_3 \sinh\alpha \cos\phi+\cosh\alpha \Be_2 \Be_3+\sinh\alpha \sin\phi \Be_2 \Be_4\right) \\
\Bx_\phi \wedge \Bx_\rho &=
\rho \sinh\alpha \left(-\Be_2 \Be_3 \sinh\alpha-\Be_2 \Be_4 \cosh\alpha \sin\phi+\cosh\alpha \cos\phi \Be_3 \Be_4\right) \\
\Bx_\rho \wedge \Bx_\alpha &=
-\Be_4 \rho \left(\cos\phi \Be_2+\sin\phi \Be_3\right),
\end{aligned}
\end{equation}

or

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4210}
\begin{aligned}
\Bx_\alpha \wedge \Bx_\phi &=
\rho^2 \sinh\alpha
\Be_2 \Be_3 \exp\lr{ \Be_4 \Be_2 e^{-\Be_2 \Be_3 \phi} \alpha } \\
\Bx_\phi \wedge \Bx_\rho &=
\rho\sinh\alpha \Be_3 \Be_4 e^{\Be_2 \Be_3 \phi} \exp\lr{
\Be_4 \Be_2 e^{\Be_2 \Be_3 \phi} \alpha
} \\
\Bx_\rho \wedge \Bx_\alpha &=
-\Be_4 \Be_2 \rho e^{\Be_2 \Be_3 \phi}.
\end{aligned}
\end{equation}

The volume element also reduces nicely, and is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4170}
\Bx_\rho \wedge \Bx_\alpha \wedge \Bx_\phi = \Be_2 \Be_3 \Be_4 \rho^2 \sinh\alpha.
\end{equation}

The area and volume element reductions were once again messy, done in software using \nbref{sphericalSurfaceAndVolumeElementsMinkowski.nb}.  However, we really only need \eqnref{eqn:stokesTheoremGeometricAlgebra:4110} to perform the Stokes integration.
}

\section{Stokes theorem, four variable volume element parameterization}

Volume elements for up to four parameters are likely of physical interest, with the four volume elements of interest for \textAndIndex{relativistic physics} in \(\bigwedge^{3,1}\) spaces.  For example, we may wish to use a parameterization \(u^1 = x, u^2 = y, u^3 = z, u^4 = \tau = c t\), with a four volume

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2040}
d^4 \Bx
=
d\Bx_x \wedge
d\Bx_y \wedge
d\Bx_z \wedge
d\Bx_\tau,
\end{dmath}

We follow the same procedure to calculate the corresponding boundary surface ``area'' element (with dimensions of volume in this case).  This is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2060}
d^4 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\lr{ d^4 \Bx \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3 du^4
\lr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 \wedge \Bx_4 }
 \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3 du_4
\lr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } {\delta_4}^i
-\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_4 } {\delta_3}^i
+\lr{ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 } {\delta_2}^i
-\lr{ \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } {\delta_1}^i
} \cdot \partial_i \Bf
=
du^1 du^2 du^3 du^4
\lr{
 \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \partial_4 \Bf
-\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_4 } \cdot \partial_3 \Bf
+\lr{ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_2 \Bf
-\lr{ \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_1 \Bf
}.
\end{dmath}

Our boundary value surface element is therefore

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2080}
d^3 \Bx =
  \Bx_1 \wedge \Bx_2 \wedge \Bx_3
- \Bx_1 \wedge \Bx_2 \wedge \Bx_4
+ \Bx_1 \wedge \Bx_3 \wedge \Bx_4
- \Bx_2 \wedge \Bx_3 \wedge \Bx_4.
\end{dmath}

where it is implied that this (and the dot products with \(\Bf\)) are evaluated on the boundaries of the integration ranges of the omitted index.  This same boundary form can be used for vector, bivector and trivector variations of Stokes theorem.

\section{Duality and its relation to the pseudoscalar.}

Looking to \eqnref{eqn:stokesTheoremGeometricAlgebra:4870} of \cref{thm:stokesTheoremGeometricAlgebra:3200}, and scaling the wedge product \(\Ba \wedge \Bb\)  by its absolute magnitude, we can express duality using that scaled bivector as a \textAndIndex{pseudoscalar} for the plane that spans \(\setlr{\Ba, \Bb}\).  Let's introduce a subscript notation for such scaled blades

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4910}
I_{\Ba\Bb} = \frac{\Ba \wedge \Bb}{\Abs{\Ba \wedge \Bb}}.
\end{dmath}

This allows us to express the unit vector in the direction of \(\Ba^\conj\) as

\boxedEquation{example:stokesTheoremGeometricAlgebra:4950}{
%\acap^\conj
\aconjcap
= \bcap \frac{\Abs{\Ba \wedge \Bb}}{\Ba \wedge \Bb}
= \bcap \inv{I_{\Ba \Bb}}.
}

Following the pattern of \eqnref{eqn:stokesTheoremGeometricAlgebra:4870}, it is clear how to express the dual vectors for higher dimensional subspaces.  For example

or for the unit vector in the direction of \(\Ba^\conj\),

\begin{equation*}
%\acap^\conj
\aconjcap
= I_{\Bb \Bc} \inv{I_{\Ba \Bb \Bc} }.
\end{equation*}

\section{Divergence theorem.}

When the curl integral is a scalar result we are able to apply duality relationships to obtain the divergence theorem for the corresponding space.  We will be able to show that a relationship of the following form holds

\index{divergence theorem}
\boxedEquation{eqn:stokesTheoremGeometricAlgebra:4810}{
\int_V dV \spacegrad \cdot \Bf = \int_{\partial V} dA_i \ncap^i \cdot \Bf.
}

Here \(\Bf\) is a vector, \(\ncap^i\) is normal to the boundary surface, and \(dA_i\) is the area of this bounding surface element.  We wish to quantify these more precisely, especially because the orientation of the normal vectors are metric dependent.  Working a few specific examples will show the pattern nicely, but it is helpful to first consider some aspects of the general case.

First note that, for a scalar Stokes integral we are integrating the vector derivative curl of a blade \(F \in \bigwedge^{k-1}\) over a k-parameter volume element.  Because the dimension of the space matches the number of parameters, the projection of the gradient onto the tangent space is exactly that gradient

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4550}
\int_V d^k \Bx \cdot (\boldpartial \wedge F)
=
\int_V d^k \Bx \cdot (\spacegrad \wedge F).
%= \int_{\partial V} d^{k-1} \Bx \cdot F.
\end{equation}

Multiplication of \(F\) by the pseudoscalar will always produce a vector.  With the introduction of such a dual vector, as in

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4570}
F = I \Bf,
\end{dmath}

Stokes theorem takes the form
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4590}
\int_V d^k \Bx \cdot \gpgrade{\spacegrad I \Bf}{k}
= \int_{\partial V} \gpgradezero{ d^{k-1} \Bx I \Bf},
\end{dmath}

or
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4610}
\int_V \gpgradezero{ d^k \Bx \spacegrad I \Bf}
= \int_{\partial V} \lr{ d^{k-1} \Bx I} \cdot \Bf,
\end{dmath}

where we will see that the vector \(d^{k-1} \Bx I\) can roughly be characterized as a normal to the boundary surface.  Using primes to indicate the scope of the action of the gradient, cyclic permutation within the scalar selection operator can be used to factor out the pseudoscalar

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4630}
\int_V \gpgradezero{ d^k \Bx \spacegrad I \Bf}
=
\int_V \gpgradezero{ \Bf' d^k \Bx \spacegrad' I}
=
\int_V \gpgrade{ \Bf' d^k \Bx \spacegrad'}{k} I
=
\int_V
(-1)^{k+1} d^k \Bx \lr{ \spacegrad \cdot \Bf} I
=
(-1)^{k+1}
I^2
\int_V
dV
\lr{ \spacegrad \cdot \Bf}.
\end{dmath}

The second last step uses \cref{thm:stokesTheoremGeometricAlgebra:4690}, and the last writes \(d^k \Bx = I^2 \Abs{d^k \Bx} = I^2 dV\), where we have assumed (without loss of generality) that \(d^k \Bx\) has the same orientation as the pseudoscalar for the space.  We also assume that the parameterization is non-degenerate over the integration volume (i.e. no \(d\Bx_i = 0\)), so the sign of this product cannot change.

Let's now return to the normal vector \(d^{k-1} \Bx I\).  With \(d^{k-1} u_i = du^1 du^2 \cdots du^{i-1} du^{i+1} \cdots du^k\) (the \(i\) indexed differential omitted), and \(I_{ab\cdots c} = (\Bx_a \wedge \Bx_b \wedge \cdots \wedge \Bx_c)/\Abs{\Bx_a \wedge \Bx_b \wedge \cdots \wedge \Bx_c}\), we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4750}
\begin{aligned}
d^{k-1} \Bx I
&=
d^{k-1} u_i \lr{ \Bx_1 \wedge \Bx_2 \wedge \cdots \wedge \Bx_k} \cdot \Bx^i I \\
&=
I_{1 2 \cdots (k-1)} I \Abs{d\Bx_1 \wedge d\Bx_2 \wedge \cdots \wedge d\Bx_{k-1} } \\
&\quad -I_{1 \cdots (k-2) k} I \Abs{d\Bx_1 \wedge \cdots \wedge d\Bx_{k-2} \wedge d\Bx_k}
+ \cdots
\end{aligned}
\end{equation}

We've seen in \eqnref{example:stokesTheoremGeometricAlgebra:4950} and \cref{thm:stokesTheoremGeometricAlgebra:4950} that the dual of vector \(\Ba\) with respect to the unit pseudoscalar \(I_{\Bb \cdots \Bc \Bd}\) in a subspace spanned by \(\setlr{\Ba, \cdots \Bc, \Bd}\) is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5010}
\widehat{\Ba^\conj} = I_{\Bb \cdots \Bc \Bd} \inv{ I_{\Ba \cdots \Bc \Bd} },
\end{equation}

or
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5030}
\widehat{\Ba^\conj} I_{\Ba \cdots \Bc \Bd}^2
=
I_{\Bb \cdots \Bc \Bd}.
\end{equation}

This allows us to write

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5050}
d^{k-1} \Bx I
=
I^2 \sum_i \widehat{\Bx^i} d{A'}_i
\end{equation}

where \(d{A'}_i = \pm dA_i\), and \(dA_i\) is the area of the boundary area element normal to \(\Bx^i\).  Note that the \(I^2\) term will now cancel cleanly from both sides of the divergence equation, taking both the metric and the orientation specific dependencies with it.

This leaves us with

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5070}
\int_V dV \spacegrad \cdot \Bf = (-1)^{k+1} \int_{\partial V} d{A'}_i \widehat{\Bx^i} \cdot \Bf.
\end{equation}

To spell out the details, we have to be very careful with the signs.  However, that is a job best left for specific examples.

\makeexample{2D divergence theorem}{example:stokesTheoremGeometricAlgebra:4690}{
\index{divergence theorem!2D}
Let's start back at

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5230}
\int_A \gpgradezero{ d^2 \Bx \spacegrad I \Bf } = \int_{\partial A} \lr{ d^1 \Bx I} \cdot \Bf.
\end{dmath}

On the left our integral can be rewritten as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5090}
\int_A \gpgradezero{ d^2 \Bx \spacegrad I \Bf }
=
-\int_A \gpgradezero{ d^2 \Bx I \spacegrad \Bf }
=
-\int_A d^2 \Bx I \lr{ \spacegrad \cdot \Bf }
=
- I^2 \int_A dA \spacegrad \cdot \Bf,
\end{dmath}

where \(d^2 \Bx = I dA\) and we pick the \textAndIndex{pseudoscalar} with the same orientation as the volume (area in this case) element \(I = (\Bx_1 \wedge \Bx_2)/\Abs{\Bx_1 \wedge \Bx_2}\).

For the boundary form we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5110}
d^1 \Bx
=
du^2 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^1
+ du^1 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^2
=
-du^2 \Bx_2
+du^1 \Bx_1.
\end{dmath}

The duality relations for the tangent space are

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5130}
\begin{aligned}
\Bx^2 &= \Bx_1 \inv{\Bx_2 \wedge \Bx_1} \\
\Bx^1 &= \Bx_2 \inv{\Bx_1 \wedge \Bx_2}
\end{aligned},
\end{equation}

or
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5150}
\begin{aligned}
\widehat{\Bx^2} &= -\widehat{\Bx_1} \inv{I} \\
\widehat{\Bx^1} &= \widehat{\Bx_2} \inv{I}
\end{aligned}.
\end{equation}

Back substitution into the line element gives

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5170}
d^1 \Bx
=
-du^2 \Abs{\Bx_2} \widehat{\Bx_2}
+du^1 \Abs{\Bx_1} \widehat{\Bx_1}
=
-du^2 \Abs{\Bx_2} \widehat{\Bx^1} I
-du^1 \Abs{\Bx_1} \widehat{\Bx^2} I.
\end{dmath}

Writing (no sum) \(du^i \Abs{\Bx_i} = ds_i\), we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5190}
d^1 \Bx I =
-\lr{ ds_2 \widehat{\Bx^1}
+ds_1 \widehat{\Bx^2} } I^2.
\end{dmath}

This provides us a divergence and normal relationship, with \(-I^2\) terms on each side that can be canceled.  Restoring explicit range evaluation, that is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5210}
%\int_{\partial A} \lr{ d^1 \Bx I } \cdot \Bf
\int_A dA \spacegrad \cdot \Bf
=
\int_{\Delta u^2} \evalbar{ ds_2 \widehat{\Bx^1} \cdot \Bf}{\Delta u^1}
+ \int_{\Delta u^1} \evalbar{ ds_1 \widehat{\Bx^2} \cdot \Bf}{\Delta u^2}
=
\int_{\Delta u^2} \evalbar{ ds_2 \widehat{\Bx^1} \cdot \Bf}{u^1(1)}
-\int_{\Delta u^2} \evalbar{ ds_2 \widehat{\Bx^1} \cdot \Bf}{u^1(0)}
+ \int_{\Delta u^1} \evalbar{ ds_1 \widehat{\Bx^2} \cdot \Bf}{u^2(0)}
- \int_{\Delta u^1} \evalbar{ ds_1 \widehat{\Bx^2} \cdot \Bf}{u^2(0)}.
\end{dmath}

Let's consider this graphically for an Euclidean metric as illustrated in \cref{fig:normalsOnSurfaceAreaElement:normalsOnSurfaceAreaElementFig10}.

\imageFigure{../../figures/gabook/normalsOnSurfaceAreaElementFig10}{Normals on area element}{fig:normalsOnSurfaceAreaElement:normalsOnSurfaceAreaElementFig10}{0.25}

We see that
\begin{itemize}
\item along \(u^2(0)\) the outwards normal is \(-\widehat{\Bx^2}\),
\item along \(u^2(1)\) the outwards normal is \(\widehat{\Bx^2}\),
\item along \(u^1(0)\) the outwards normal is \(-\widehat{\Bx^1}\), and
\item along \(u^1(1)\) the outwards normal is \(\widehat{\Bx^2}\).
\end{itemize}

Writing that outwards normal as \(\ncap\), we have

\boxedEquation{eqn:stokesTheoremGeometricAlgebra:5250}{
\int_A dA \spacegrad \cdot \Bf
=
\ointctrclockwise ds \ncap \cdot \Bf.
}

Note that we can use the same algebraic notion of outward normal for non-Euclidean spaces, although cannot expect the geometry to look anything like that of the figure.
}

\makeexample{3D divergence theorem}{example:stokesTheoremGeometricAlgebra:4470}{
\index{divergence theorem!3D}
As with the 2D example, let's start back with

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5330}
\int_V \gpgradezero{ d^3 \Bx \spacegrad I \Bf } = \int_{\partial V} \lr{ d^2 \Bx I} \cdot \Bf.
\end{dmath}

In a 3D space, the pseudoscalar commutes with all grades, so we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5350}
\int_V \gpgradezero{ d^3 \Bx \spacegrad I \Bf }
=
\int_V \lr{ d^3 \Bx I } \spacegrad \cdot \Bf
=
I^2 \int_V dV \spacegrad \cdot \Bf,
\end{dmath}

where \(d^3 \Bx I = dV I^2\), and we have used a pseudoscalar with the same orientation as the volume element

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5390}
\begin{aligned}
I &= \widehat{ \Bx_{123} } \\
\Bx_{123} &= \Bx_1 \wedge \Bx_2 \wedge \Bx_3.
\end{aligned}
\end{equation}

In the boundary integral our dual two form is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5370}
d^2 \Bx I
=
 du^1 du^2 \Bx_1 \wedge \Bx_2
+du^3 du^1 \Bx_3 \wedge \Bx_1
+du^2 du^3 \Bx_2 \wedge \Bx_3
=
\lr{
% dA_{3} \widehat{\Bx_1 \wedge \Bx_2} \inv{I}
%+dA_{2} \widehat{\Bx_3 \wedge \Bx_1} \inv{I}
%+dA_{1} \widehat{\Bx_2 \wedge \Bx_3} \inv{I}
 dA_{3} \widehat{ \Bx_{12} } \inv{I}
+dA_{2} \widehat{ \Bx_{31} } \inv{I}
+dA_{1} \widehat{ \Bx_{23} } \inv{I}
} I^2,
\end{dmath}

where \(\Bx_{ij} = \Bx_i \wedge \Bx_j\), and

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5410}
\begin{aligned}
dA_1 &= \Abs{d\Bx_2 \wedge d\Bx_3} \\
dA_2 &= \Abs{d\Bx_3 \wedge d\Bx_1} \\
dA_3 &= \Abs{d\Bx_1 \wedge d\Bx_2}.
\end{aligned}
\end{equation}

Observe that we can do a cyclic permutation of a 3 blade without any change of sign, for example

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5430}
\Bx_1 \wedge \Bx_2 \wedge \Bx_3 =
-\Bx_2 \wedge \Bx_1 \wedge \Bx_3 =
\Bx_2 \wedge \Bx_3 \wedge \Bx_1.
\end{equation}

Because of this we can write the dual two form as we expressed the normals in \cref{thm:stokesTheoremGeometricAlgebra:4950}

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5450}
d^2 \Bx I = \lr{
   dA_1
   \widehat{\Bx_{23}}
   \inv{\widehat{\Bx_{123}}}
   +
   dA_2
   \widehat{\Bx_{31}}
   \inv{\widehat{\Bx_{231}}}
   +
   dA_3
   \widehat{\Bx_{12}}
   \inv{\widehat{\Bx_{312}}}
} I^2
=
\lr{ dA_1 \widehat{\Bx^1}
+dA_2 \widehat{\Bx^2}
+dA_3 \widehat{\Bx^3} } I^2.
\end{dmath}

We can now state the 3D divergence theorem, canceling out the metric and orientation dependent term \(I^2\) on both sides

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5470}
\int_V dV \spacegrad \cdot \Bf
=
\int dA \ncap \cdot \Bf,
\end{equation}

where (sums implied)

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5490}
dA \ncap = dA_i \widehat{\Bx^i},
\end{equation}

and
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5510}
\begin{aligned}
\evalbar{\ncap}{u^i = u^i(1)} &= \widehat{\Bx^i} \\
\evalbar{\ncap}{u^i = u^i(0)} &= -\widehat{\Bx^i}
\end{aligned}.
\end{equation}

The outwards normals at the upper integration ranges of a three parameter surface are depicted in \cref{fig:normalsOnVolumeAreaElement:normalsOnVolumeAreaElementFig11}.

\imageFigure{../../figures/gabook/normalsOnVolumeAreaElementFig11}{Outwards normals on volume at upper integration ranges.}{fig:normalsOnVolumeAreaElement:normalsOnVolumeAreaElementFig11}{0.25}

This sign alternation originates with the two form elements \(\lr{d\Bx_i \wedge d\Bx_j} \cdot F\) from the Stokes boundary integral, which were explicitly evaluated at the endpoints of the integral.  That is, for \(k \ne i,j\),

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5530}
\int_{\partial V} \lr{ d\Bx_i \wedge d\Bx_j } \cdot F
\equiv
\int_{\Delta u^i} \int_{\Delta u^j}
\evalbar{\lr{ \lr{ d\Bx_i \wedge d\Bx_j } \cdot F }}{u^k = u^k(1)}
-\evalbar{\lr{ \lr{ d\Bx_i \wedge d\Bx_j } \cdot F }}{u^k = u^k(0)}
\end{equation}

In the context of the divergence theorem, this means that we are implicitly requiring the dot products \(\widehat{\Bx^k} \cdot \Bf\) to be evaluated specifically at the end points of the integration where \(u^k = u^k(1), u^k = u^k(0)\), accounting for the alternation of sign required to describe the normals as uniformly outwards.
}

\makeexample{4D divergence theorem}{example:stokesTheoremGeometricAlgebra:5270}{
\index{divergence theorem!4D}
Applying Stokes theorem to a trivector \(T = I \Bf\) in the 4D case we find

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5830}
-I^2 \int_V d^4 x \spacegrad \cdot \Bf =
\int_{\partial V} \lr{ d^3 \Bx I} \cdot \Bf.
\end{dmath}

Here the pseudoscalar has been picked to have the same orientation as the hypervolume element \(d^4 \Bx = I d^4 x\).  Writing \(\Bx_{ij \cdots k} = \Bx_i \wedge \Bx_j \wedge \cdots \Bx_k\) the dual of the three form is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5550}
d^3 \Bx I
=
\lr{
 du^1 du^2 du^3 \Bx_{123}
-du^1 du^2 du^4 \Bx_{124}
+du^1 du^3 du^4 \Bx_{134}
-du^2 du^3 du^4 \Bx_{234}
} I
=
\lr{
    dA^{123} \widehat{ \Bx_{123} }
   -dA^{124} \widehat{ \Bx_{124} }
   +dA^{134} \widehat{ \Bx_{134} }
   -dA^{234} \widehat{ \Bx_{234} }
} I
=
\lr{
    dA^{123} \widehat{ \Bx_{123} } \inv{\widehat{\Bx_{1234} }}
   -dA^{124} \widehat{ \Bx_{124} } \inv{\widehat{\Bx_{1234} }}
   +dA^{134} \widehat{ \Bx_{134} } \inv{\widehat{\Bx_{1234} }}
   -dA^{234} \widehat{ \Bx_{234} } \inv{\widehat{\Bx_{1234} }}
} I^2
=
-\lr{
    dA^{123} \widehat{ \Bx_{123} } \inv{\widehat{\Bx_{4123} }}
   +dA^{124} \widehat{ \Bx_{124} } \inv{\widehat{\Bx_{3412} }}
   +dA^{134} \widehat{ \Bx_{134} } \inv{\widehat{\Bx_{2341} }}
   +dA^{234} \widehat{ \Bx_{234} } \inv{\widehat{\Bx_{1234} }}
} I^2
=
-\lr{
    dA^{123} \widehat{ \Bx_{123} } \inv{\widehat{\Bx_{4123} }}
   +dA^{124} \widehat{ \Bx_{412} } \inv{\widehat{\Bx_{3412} }}
   +dA^{134} \widehat{ \Bx_{341} } \inv{\widehat{\Bx_{2341} }}
   +dA^{234} \widehat{ \Bx_{234} } \inv{\widehat{\Bx_{1234} }}
} I^2
=
-\lr{
    dA^{123} \widehat{ \Bx^{4} }
   +dA^{124} \widehat{ \Bx^{3} }
   +dA^{134} \widehat{ \Bx^{2} }
   +dA^{234} \widehat{ \Bx^{1} }
} I^2
\end{dmath}

Here, we've written

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5570}
dA^{ijk} = \Abs{ d\Bx_i \wedge d\Bx_j \wedge d\Bx_k }.
\end{dmath}

Observe that the dual representation nicely removes the alternation of sign that we had in the Stokes theorem boundary integral, since each alternation of the wedged vectors in the pseudoscalar changes the sign once.

As before, we define the outwards normals as \(\ncap = \pm \widehat{\Bx^i}\) on the upper and lower integration ranges respectively.  The scalar area elements on these faces can be written in a dual form

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5590}
\begin{aligned}
   dA_4 &= dA^{123} \\
   dA_3 &= dA^{124} \\
   dA_2 &= dA^{134} \\
   dA_1 &= dA^{234}
\end{aligned},
\end{equation}

so that the 4D divergence theorem looks just like the 2D and 3D cases

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5610}
\int_V d^4 x \spacegrad \cdot \Bf =
\int_{\partial V} d^3 x \ncap \cdot \Bf.
\end{equation}

Here we define the volume scaled normal as

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5630}
d^3 x \ncap = dA_i \widehat{\Bx^i}.
\end{equation}

As before, we have made use of the implicit fact that the three form (and it's dot product with \(\Bf\)) was evaluated on the boundaries of the integration region, with a toggling of sign on the lower limit of that evaluation that is now reflected in what we have defined as the outwards normal.

We also obtain explicit instructions from this formalism how to compute the ``outwards'' normal for this surface in a 4D space (unit scaling of the dual basis elements), something that we cannot compute using any sort of geometrical intuition.  For free we've obtained a result that applies to both Euclidean and Minkowski (or other non-Euclidean) spaces.
}

\section{Volume integral coordinate representations}

It may be useful to formulate the curl integrals in \textAndIndex{tensor} form.  For vectors \(\Bf\), and bivectors \index{bivector} \(B\), the coordinate representations of those differential forms (\cref{pr:stokesTheoremGeometricAlgebra:1}) are

\begin{subequations}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2160}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
- d^2 u \epsilon^{ a b } \partial_a f_b
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2180}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
-
%\inv{2}
d^3 u \epsilon^{a b c} \Bx_a \partial_b f_{c}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2200}
d^4 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
-\inv{2} d^4 u \epsilon^{a b c d} \Bx_a \wedge \Bx_b \partial_{c} f_{d}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2220}
d^3 \Bx \cdot \lr{ \boldpartial \wedge B }
=
-
\inv{2}
d^3 u \epsilon^{a b c} \partial_a B_{b c}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2240}
d^4 \Bx \cdot \lr{ \boldpartial \wedge B }
=
-\inv{2} d^4 u \epsilon^{a b c d} \Bx_a \partial_b B_{cd}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2340}
d^4 \Bx \cdot \lr{ \boldpartial \wedge T }
=
-
d^4 u
\lr{
\partial_4 T_{123}
-\partial_3 T_{124}
+\partial_2 T_{134}
-\partial_1 T_{234}
}.
\end{equation}
\end{subequations}

Here the bivector \(B\) and \textAndIndex{trivector} \(T\) is expressed in terms of their curvilinear components on the tangent space

\begin{subequations}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2260}
B = \inv{2} \Bx^i \wedge \Bx^j B_{ij} + B_\perp
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2270}
T = \inv{3!} \Bx^i \wedge \Bx^j \wedge \Bx^k T_{ijk} + T_\perp,
\end{equation}
\end{subequations}

where

\begin{subequations}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2280}
B_{ij} = \Bx_j \cdot \lr{ \Bx_i \cdot B } = -B_{ji}.
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2290}
T_{ijk} = \Bx_k \cdot \lr{ \Bx_j \cdot \lr{ \Bx_i \cdot B }}.
\end{equation}
\end{subequations}

For the trivector components are also antisymmetric, changing sign with any interchange of indices.

Note that \eqnref{eqn:stokesTheoremGeometricAlgebra:2220} and \eqnref{eqn:stokesTheoremGeometricAlgebra:2340} appear much different on the surface, but both have the same structure.  This can be seen by writing for former as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2640}
d^3 \Bx \cdot \lr{ \boldpartial \wedge B }
=
-
d^3 u
\lr{
    \partial_1 B_{2 3}
  + \partial_2 B_{3 1}
  + \partial_3 B_{1 2}
}
=
-
d^3 u
\lr{
    \partial_3 B_{1 2}
  - \partial_2 B_{1 3}
  + \partial_1 B_{2 3}
}.
\end{dmath}

In both of these we have an alternation of sign, where the tensor index skips one of the volume element indices is sequence.  We've seen in the 4D divergence theorem that this alternation of sign can be related to a duality transformation.

In integral form (no sum over indexes \(i\) in \(du^i\) terms), these are

\begin{subequations}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5650}
\int d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
- \epsilon^{ a b } \int \evalbar{du^b f_b}{\Delta u^a}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5670}
\int d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
-
\epsilon^{a b c} \int
du^a du^c
\evalbar{\Bx_a f_{c}}{\Delta u^b}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5690}
\int d^4 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
-\inv{2} \epsilon^{a b c d} \int
du^a du^b du^d
\evalbar{\Bx_a \wedge \Bx_b f_{d}}{\Delta u^c}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5710}
\int d^3 \Bx \cdot \lr{ \boldpartial \wedge B }
=
-
\inv{2}
\epsilon^{a b c}
\int
du^b du^c
\evalbar{B_{b c}}{\Delta u^a}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5730}
\int d^4 \Bx \cdot \lr{ \boldpartial \wedge B }
=
-\inv{2}
\epsilon^{a b c d}
\int
du^a du^c du^d
\evalbar{\Bx_a B_{cd}}{\Delta u^b}
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:5750}
\begin{aligned}
\int &d^4 \Bx \cdot \lr{ \boldpartial \wedge T }
= \\
&
\int
du^1 du^2 du^3 \evalbar{T_{123}}{\Delta u^4}
-\int
du^1 du^2 du^4 \evalbar{T_{124}}{\Delta u^3} \\
&+\int
du^1 du^3 du^4 \evalbar{T_{134}}{\Delta u^2}
-\int
du^2 du^3 du^4 \evalbar{T_{234}}{\Delta u^1}
.
\end{aligned}
\end{equation}
\end{subequations}

Of these, I suspect that only \eqnref{eqn:stokesTheoremGeometricAlgebra:5650} and \eqnref{eqn:stokesTheoremGeometricAlgebra:5710} are of use.

\section{Final remarks}

Because we have used curvilinear coordinates from the get go, we have arrived naturally at a formulation that works for both Euclidean and non-Euclidean geometries, and have demonstrated that Stokes (and the divergence theorem) holds regardless of the geometry or the parameterization.  We also know explicitly how to formulate both theorems for any parameterization that we choose, something much more valuable than knowledge that this is possible.

For the divergence theorem we have introduced the concept of outwards normal (for example in 3D, \eqnref{eqn:stokesTheoremGeometricAlgebra:5510}), which still holds for non-Euclidean geometries.  We may not be able to form intuitive geometrical interpretations for these normals, but do have an algebraic description of them.

\section{Problems}

\makeproblem{Expand volume elements in coordinates}{pr:stokesTheoremGeometricAlgebra:1}{
Show that the coordinate representation for the volume element dotted with the curl can be represented as a sum of antisymmetric terms.  That is

\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2160}
}{pr:stokesTheoremGeometricAlgebra:a}
\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2180}
}{pr:stokesTheoremGeometricAlgebra:b}
\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2200}
}{pr:stokesTheoremGeometricAlgebra:c}
\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2220}
}{pr:stokesTheoremGeometricAlgebra:d}
\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2240}
}{pr:stokesTheoremGeometricAlgebra:e}
\makesubproblem{Prove
\eqnref{eqn:stokesTheoremGeometricAlgebra:2340}
}{pr:stokesTheoremGeometricAlgebra:f}
} % makeproblem

\makeanswer{pr:stokesTheoremGeometricAlgebra:1}{

\makeSubAnswer{Two parameter volume, curl of vector}{pr:stokesTheoremGeometricAlgebra:a}

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2380}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
d^2 u
\biglr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot \partial_i \Bf
=
d^2 u
\lr{
\Bx_1 \cdot \partial_2 \Bf
-\Bx_2 \cdot \partial_1 \Bf
}
=
d^2 u
\lr{
\partial_2 f_1
-\partial_1 f_2
}
=
- d^2 u \epsilon^{ab} \partial_{a} f_{b}. \qedmarker
\end{dmath}

\makeSubAnswer{Three parameter volume, curl of vector}{pr:stokesTheoremGeometricAlgebra:b}

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2400}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
d^3 u
\biglr{ \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \Bx^i } \cdot \partial_i \Bf
=
d^3 u
\biglr{
 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
+\lr{ \Bx_3 \wedge \Bx_1 } \cdot \partial_2 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 \Bf
}
=
d^3 u
\biglr{
\lr{ \Bx_1 \partial_3 \Bf \cdot \Bx_2 -\Bx_2 \partial_3 \Bf \cdot \Bx_1 }
+\lr{ \Bx_3 \partial_2 \Bf \cdot \Bx_1 -\Bx_1 \partial_2 \Bf \cdot \Bx_3 }
+\lr{ \Bx_2 \partial_1 \Bf \cdot \Bx_3 -\Bx_3 \partial_1 \Bf \cdot \Bx_2 }
}
=
d^3 u
\biglr{
\Bx_1 \lr{ -\partial_2 \Bf \cdot \Bx_3 + \partial_3 \Bf \cdot \Bx_2 }
+\Bx_2 \lr{ -\partial_3 \Bf \cdot \Bx_1 + \partial_1 \Bf \cdot \Bx_3 }
+\Bx_3 \lr{ -\partial_1 \Bf \cdot \Bx_2 + \partial_2 \Bf \cdot \Bx_1 }
}
=
d^3 u
\biglr{
\Bx_1 \lr{ -\partial_2 f_3 + \partial_3 f_2 }
+\Bx_2 \lr{ -\partial_3 f_1 + \partial_1 f_3 }
+\Bx_3 \lr{ -\partial_1 f_2 + \partial_2 f_1 }
}
= - d^3 u \epsilon^{abc} \partial_b f_c. \qedmarker
\end{dmath}

\makeSubAnswer{Four parameter volume, curl of vector}{pr:stokesTheoremGeometricAlgebra:c}

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2420}
\begin{aligned}
d^4 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
&=
d^4 u
\biglr{ \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } \cdot \Bx^i } \cdot \partial_i \Bf \\
&=
d^4 u
\biglr{
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \partial_4 \Bf
-\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_4 } \cdot \partial_3 \Bf
+\lr{ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_2 \Bf
-\lr{ \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_1 \Bf
} \\
&=
d^4 u
\biglr{  \\
&\quad\quad \lr{ \Bx_1 \wedge \Bx_2 } \Bx_3 \cdot \partial_4 \Bf
-\lr{ \Bx_1 \wedge \Bx_3 } \Bx_2 \cdot \partial_4 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \Bx_1 \cdot \partial_4 \Bf \\
%
&\quad-\lr{ \Bx_1 \wedge \Bx_2 } \Bx_4 \cdot \partial_3 \Bf
+\lr{ \Bx_1 \wedge \Bx_4 } \Bx_2 \cdot \partial_3 \Bf
-\lr{ \Bx_2 \wedge \Bx_4 } \Bx_1 \cdot \partial_3 \Bf \\
%
&\quad+ \lr{ \Bx_1 \wedge \Bx_3 } \Bx_4 \cdot \partial_2 \Bf
-\lr{ \Bx_1 \wedge \Bx_4 } \Bx_3 \cdot \partial_2 \Bf
+\lr{ \Bx_3 \wedge \Bx_4 } \Bx_1 \cdot \partial_2 \Bf \\
%
&\quad-\lr{ \Bx_2 \wedge \Bx_3 } \Bx_4 \cdot \partial_1 \Bf
+\lr{ \Bx_2 \wedge \Bx_4 } \Bx_3 \cdot \partial_1 \Bf
-\lr{ \Bx_3 \wedge \Bx_4 } \Bx_2 \cdot \partial_1 \Bf \\
&\qquad
} \\
&=
d^4 u
\biglr{
\Bx_1 \wedge \Bx_2 \partial_{[4} f_{3]}
+\Bx_1 \wedge \Bx_3 \partial_{[2} f_{4]}
+\Bx_1 \wedge \Bx_4 \partial_{[3} f_{2]}
+\Bx_2 \wedge \Bx_3 \partial_{[4} f_{1]}
+\Bx_2 \wedge \Bx_4 \partial_{[1} f_{3]}
+\Bx_3 \wedge \Bx_4 \partial_{[2} f_{1]}
} \\
&=
- \inv{2} d^4 u \epsilon^{abcd} \Bx_a \wedge \Bx_b \partial_{c} f_{d}. \qedmarker
\end{aligned}
\end{equation}

\makeSubAnswer{Three parameter volume, curl of bivector}{pr:stokesTheoremGeometricAlgebra:d}

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2440}
\begin{aligned}
d^3 \Bx \cdot \lr{ \boldpartial \wedge B }
&=
d^3 u
\biglr{ \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \Bx^i } \cdot \partial_i B \\
&=
d^3 u
\biglr{
 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 B
+\lr{ \Bx_3 \wedge \Bx_1 } \cdot \partial_2 B
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 B
} \\
&=
\inv{2} d^3 u
\biglr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot \partial_3 B } -\Bx_2 \cdot \lr{ \Bx_1 \cdot \partial_3 B } \\
&\qquad +\Bx_3 \cdot \lr{ \Bx_1 \cdot \partial_2 B } -\Bx_1 \cdot \lr{ \Bx_3 \cdot \partial_2 B } \\
&\qquad +\Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_1 B } -\Bx_3 \cdot \lr{ \Bx_2 \cdot \partial_1 B }
} \\
&=
\inv{2} d^3 u
\biglr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot \partial_3 B - \Bx_3 \cdot \partial_2 B } \\
&\qquad +\Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_1 B - \Bx_1 \cdot \partial_3 B } \\
&\qquad +\Bx_3 \cdot \lr{ \Bx_1 \cdot \partial_2 B - \Bx_2 \cdot \partial_1 B }
} \\
&=
\inv{2} d^3 u
\biglr{
\Bx_1 \cdot \lr{ \partial_3 \lr{ \Bx_2 \cdot B} - \partial_2 \lr{ \Bx_3 \cdot B} } \\
&\qquad +\Bx_2 \cdot \lr{ \partial_1 \lr{ \Bx_3 \cdot B} - \partial_3 \lr{ \Bx_1 \cdot B} } \\
&\qquad +\Bx_3 \cdot \lr{ \partial_2 \lr{ \Bx_1 \cdot B} - \partial_1 \lr{ \Bx_2 \cdot B} }
} \\
&=
\inv{2} d^3 u
\biglr{
\partial_2 \lr{ \Bx_3 \cdot \lr{ \Bx_1 \cdot B} } - \partial_3 \lr{ \Bx_2 \cdot \lr{ \Bx_1 \cdot B} } \\
%
&\qquad+ \partial_3 \lr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot B} } - \partial_1 \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot B} } \\
%
&\qquad+ \partial_1 \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot B} } - \partial_2 \lr{ \Bx_1 \cdot \lr{ \Bx_3 \cdot B} }
} \\
&=
\inv{2} d^3 u
\biglr{
\partial_2 B_{13} - \partial_3 B_{12}
+\partial_3 B_{21} - \partial_1 B_{23}
+\partial_1 B_{32} - \partial_2 B_{31}
} \\
&=
d^3 u
\biglr{
\partial_2 B_{13}
+\partial_3 B_{21}
+\partial_1 B_{32}
} \\
&= - \inv{2} d^3 u \epsilon^{abc} \partial_a B_{bc}. \qedmarker
\end{aligned}
\end{equation}

\makeSubAnswer{Four parameter volume, curl of bivector}{pr:stokesTheoremGeometricAlgebra:e}

To start, we require \cref{thm:stokesTheoremGeometricAlgebra:2460}.  For convenience lets also write our wedge products as a single indexed quantity, as in \(\Bx_{abc}\) for \(\Bx_a \wedge \Bx_b \wedge \Bx_c\).  The expansion is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2500}
\begin{aligned}
d^4 \Bx \cdot \lr{ \boldpartial \wedge B }
&=
d^4 u
\lr{ \Bx_{1234} \cdot \Bx^i } \cdot \partial_i B  \\
&=
d^4 u
\lr{
\Bx_{123} \cdot \partial_4 B
-\Bx_{124} \cdot \partial_3 B
+\Bx_{134} \cdot \partial_2 B
-\Bx_{234} \cdot \partial_1 B
} \\
&=
d^4 u
\biglr{
\Bx_1 \lr{ \Bx_{23} \cdot \partial_4 B }
+\Bx_2 \lr{ \Bx_{32} \cdot \partial_4 B }
+\Bx_3 \lr{ \Bx_{12} \cdot \partial_4 B } \\
%
&\qquad -\Bx_1 \lr{ \Bx_{24} \cdot \partial_3 B }
-\Bx_2 \lr{ \Bx_{41} \cdot \partial_3 B }
-\Bx_4 \lr{ \Bx_{12} \cdot \partial_3 B } \\
%
&\qquad +\Bx_1 \lr{ \Bx_{34} \cdot \partial_2 B }
+\Bx_3 \lr{ \Bx_{41} \cdot \partial_2 B }
+\Bx_4 \lr{ \Bx_{13} \cdot \partial_2 B } \\
%
&\qquad -\Bx_2 \lr{ \Bx_{34} \cdot \partial_1 B }
-\Bx_3 \lr{ \Bx_{42} \cdot \partial_1 B }
-\Bx_4 \lr{ \Bx_{23} \cdot \partial_1 B }
} \\
&=
d^4 u
\biglr{
\Bx_1 \lr{
 \Bx_{23} \cdot \partial_4 B
+\Bx_{42} \cdot \partial_3 B
+\Bx_{34} \cdot \partial_2 B
} \\
%
&\qquad +\Bx_2 \lr{
 \Bx_{32} \cdot \partial_4 B
+\Bx_{14} \cdot \partial_3 B
+\Bx_{43} \cdot \partial_1 B
} \\
%
&\qquad +\Bx_3 \lr{
 \Bx_{12} \cdot \partial_4 B
+\Bx_{41} \cdot \partial_2 B
+\Bx_{24} \cdot \partial_1 B
} \\
%
&\qquad +\Bx_4 \lr{
 \Bx_{21} \cdot \partial_3 B
+\Bx_{13} \cdot \partial_2 B
+\Bx_{32} \cdot \partial_1 B
}
} \\
&=
-\inv{2} d^4 u \epsilon^{a b c d} \Bx_a \partial_b B_{c d}.  \qedmarker
\end{aligned}
\end{equation}

This last step uses an intermediate result from the \eqnref{eqn:stokesTheoremGeometricAlgebra:2440} expansion above, since each of the four terms has the same structure we have previously observed.

\makeSubAnswer{Four parameter volume, curl of trivector}{pr:stokesTheoremGeometricAlgebra:f}

Using the \(\Bx_{ijk}\) shorthand again, the initial expansion gives

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2520}
d^4 \Bx \cdot \lr{ \boldpartial \wedge T }
=
d^4 u
\lr{
\Bx_{123} \cdot \partial_4 T
-\Bx_{124} \cdot \partial_3 T
+\Bx_{134} \cdot \partial_2 T
-\Bx_{234} \cdot \partial_1 T
}.
\end{dmath}

Applying \cref{thm:stokesTheoremGeometricAlgebra:2560} to expand the inner products within the braces we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2720}
\begin{aligned}
\Bx_{123} \cdot \partial_4 T
-&\Bx_{124} \cdot \partial_3 T
+\Bx_{134} \cdot \partial_2 T
-\Bx_{234} \cdot \partial_1 T \\
&=
\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_4 T } }
-\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_4 \cdot \partial_3 T } }  \\
&\quad +
\mathLabelBox
[
   labelstyle={xshift=2cm},
   linestyle={out=270,in=90, latex-}
]
{
\Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_4 \cdot \partial_2 T } }
-\Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_4 \cdot \partial_1 T } }
}{Apply cyclic permutations \index{cyclic permutation}}
\\
&=
\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_4 T } }
-\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_4 \cdot \partial_3 T } }  \\
&\quad +\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot \partial_2 T } }
-\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_2 \cdot \partial_1 T } }  \\
&=
\Bx_1 \cdot \lr{ \Bx_2 \cdot
\lr{
\Bx_3 \cdot \partial_4 T
-\Bx_4 \cdot \partial_3 T
} }  \\
&\quad +\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{
\Bx_1 \cdot \partial_2 T
-\Bx_2 \cdot \partial_1 T
} }  \\
&=
\Bx_1 \cdot \lr{ \Bx_2 \cdot
\lr{
\partial_4 \lr{ \Bx_3 \cdot T }
-\partial_3 \lr{ \Bx_4 \cdot T }
} }  \\
&\quad +\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{
\partial_2 \lr{ \Bx_1 \cdot T }
-\partial_1 \lr{ \Bx_2 \cdot T }
} }  \\
&=
\Bx_1 \cdot \partial_4 \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot T } }
+\Bx_2 \cdot \partial_3 \lr{ \Bx_1 \cdot \lr{ \Bx_4 \cdot T } } \\
&\quad +\Bx_3 \cdot \partial_2 \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot T } }
+\Bx_4 \cdot \partial_1 \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot T } } \\
&
-\Bx_1 \cdot \lr{ \lr{ \partial_4 \Bx_2} \cdot \lr{ \Bx_3 \cdot T } }
-\Bx_2 \cdot \lr{ \lr{ \partial_3 \Bx_1} \cdot \lr{ \Bx_4 \cdot T } }  \\
&\quad -\Bx_3 \cdot \lr{ \lr{ \partial_2 \Bx_4} \cdot \lr{ \Bx_1 \cdot T } }
-\Bx_4 \cdot \lr{ \lr{ \partial_1 \Bx_3} \cdot \lr{ \Bx_2 \cdot T } }  \\
&=
\Bx_1 \cdot \partial_4 \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot T } }
+\Bx_2 \cdot \partial_3 \lr{ \Bx_1 \cdot \lr{ \Bx_4 \cdot T } } \\
&\quad +\Bx_3 \cdot \partial_2 \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot T } }
+\Bx_4 \cdot \partial_1 \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot T } } \\
&
+
\frac{\partial^2 \Bx}{\partial u^4 \partial u^2}
\cdot
\cancel{
\lr{
\Bx_1 \cdot \lr{ \Bx_3 \cdot T }
+\Bx_3 \cdot \lr{ \Bx_1 \cdot T }
}
} \\
&\quad +
\frac{\partial^2 \Bx}{\partial u^1 \partial u^3}
\cdot
\cancel{
\lr{
\Bx_2 \cdot \lr{ \Bx_4 \cdot T }
+\Bx_4 \cdot \lr{ \Bx_2 \cdot T }
}
}.
\end{aligned}
\end{equation}

We can cancel those last terms using \cref{thm:stokesTheoremGeometricAlgebra:2740}.  Using the same reverse chain rule expansion once more we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2800}
\begin{aligned}
\Bx_{123} \cdot \partial_4 T
-&\Bx_{124} \cdot \partial_3 T
+\Bx_{134} \cdot \partial_2 T
-\Bx_{234} \cdot \partial_1 T \\
&=
\partial_4 \lr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot T } } }
+\partial_3 \lr{ \Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_4 \cdot T } } }
+\partial_2 \lr{ \Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot T } } }
+\partial_1 \lr{ \Bx_4 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot T } } } \\
&-
\lr{ \partial_4 \Bx_1}
\cdot
\cancel{
\lr{
\Bx_2 \cdot \lr{ \Bx_3 \cdot T }
+\Bx_3 \cdot \lr{ \Bx_2 \cdot T }
}
}
-\lr{ \partial_3 \Bx_2} \cdot
\cancel{
\lr{
\Bx_1 \cdot \lr{ \Bx_4 \cdot T }
\Bx_4 \cdot \lr{ \Bx_1 \cdot T }
}
},
\end{aligned}
\end{equation}

or
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2820}
d^4 \Bx \cdot \lr{ \boldpartial \wedge T }
=
d^4 u
\biglr{
\partial_4 T_{3 2 1}
+\partial_3 T_{4 1 2}
+\partial_2 T_{1 4 3}
+\partial_1 T_{2 3 4}
}.
\end{dmath}

The final result follows after permuting the indices slightly.

%%%Expanding \(6 \times\) the portion in the braces, we have
%%%
%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2540}
%%%\begin{aligned}
%%%6 \biglr{ \Bx_{123} \cdot \partial_4 T
%%%-\Bx_{124} \cdot \partial_3 T
%%%+\Bx_{134} \cdot \partial_2 T
%%%-\Bx_{234} \cdot \partial_1 T
%%%}
%%%&=
%%%\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_4 T }}
%%%-\Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot \partial_4 T }} \\
%%%&\quad +\Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_1 \cdot \partial_4 T }}
%%%-\Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_3 \cdot \partial_4 T }} \\
%%%&\quad +\Bx_3 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot \partial_4 T }}
%%%-\Bx_3 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_1 \cdot \partial_4 T }} \\
%%%%
%%%&
%%%-\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_4 \cdot \partial_3 T }}
%%%+\Bx_1 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_2 \cdot \partial_3 T }} \\
%%%&\quad -\Bx_2 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot \partial_3 T }}
%%%+\Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_4 \cdot \partial_3 T }} \\
%%%&\quad -\Bx_4 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_2 \cdot \partial_3 T }}
%%%+\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_1 \cdot \partial_3 T }} \\
%%%%
%%%&
%%%+ \Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_4 \cdot \partial_2 T }}
%%%- \Bx_1 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_3 \cdot \partial_2 T }} \\
%%%&\quad +\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_1 \cdot \partial_2 T }}
%%%-\Bx_3 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_4 \cdot \partial_2 T }} \\
%%%&\quad +\Bx_4 \cdot \lr{ \Bx_1 \cdot \lr{ \Bx_3 \cdot \partial_2 T }}
%%%-\Bx_4 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_1 \cdot \partial_2 T }} \\
%%%%
%%%&- \Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_4 \cdot \partial_1 T }}
%%%+\Bx_2 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_3 \cdot \partial_1 T }} \\
%%%&\quad -\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \Bx_2 \cdot \partial_1 T }}
%%%+\Bx_3 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_4 \cdot \partial_1 T }} \\
%%%&\quad -\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ \Bx_3 \cdot \partial_1 T }}
%%%+\Bx_4 \cdot \lr{ \Bx_3 \cdot \lr{ \Bx_2 \cdot \partial_1 T }}
%%%\end{aligned}
%%%\end{equation}

%%%This can be combined pairwise as before, allowing for the cancelation of asymmetric derivatives of \(\Bx_a\) terms.  That first grouping yields
%%%
%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2620}
%%%\begin{aligned}
%%%%6 \biglr{ \Bx_{123} \cdot \partial_4 T
%%%%-\Bx_{124} \cdot \partial_3 T
%%%%+\Bx_{134} \cdot \partial_2 T
%%%%-\Bx_{234} \cdot \partial_1 T
%%%%}
%%%%&=
%%%&\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ \partial_{[4} \Bx_{3]} \cdot T }}
%%%+\Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ \partial_{[2} \Bx_{4]} \cdot T }}
%%%+\Bx_1 \cdot \lr{ \Bx_4 \cdot \lr{ \partial_{[3} \Bx_{2]} \cdot T }} \\
%%%&+\Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ \partial_{[3} \Bx_{4]} \cdot T }}
%%%+\Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ \partial_{[4} \Bx_{1]} \cdot T }}
%%%+\Bx_2 \cdot \lr{ \Bx_4 \cdot \lr{ \partial_{[1} \Bx_{3]} \cdot T }} \\
%%%&+\Bx_3 \cdot \lr{ \Bx_1 \cdot \lr{ \partial_{[4} \Bx_{2]} \cdot T }}
%%%+\Bx_3 \cdot \lr{ \Bx_2 \cdot \lr{ \partial_{[1} \Bx_{4]} \cdot T }}
%%%+\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ \partial_{[2} \Bx_{1]} \cdot T }} \\
%%%&+\Bx_4 \cdot \lr{ \Bx_1 \cdot \lr{ \partial_{[2} \Bx_{3]} \cdot T }}
%%%+\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ \partial_{[3} \Bx_{1]} \cdot T }}
%%%+\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ \partial_{[1} \Bx_{2]} \cdot T }}
%%%\end{aligned}
%%%\end{equation}
%%%
%%%FIXME: complete (preferably finding a smarter way).
%Regrouping these
%
%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2620}
%\begin{aligned}
%\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ +\partial_4 \Bx_3 \cdot T }}
%\Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ -\partial_4 \Bx_3 \cdot T }}
%\Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ -\partial_4 \Bx_2 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_1 \cdot \lr{ +\partial_4 \Bx_2 \cdot T }}
%\Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ +\partial_4 \Bx_1 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_2 \cdot \lr{ -\partial_4 \Bx_1 \cdot T }}
%
%\Bx_1 \cdot \lr{ \Bx_2 \cdot \lr{ -\partial_3 \Bx_4 \cdot T }}
%\Bx_1 \cdot \lr{ \Bx_4 \cdot \lr{ +\partial_3 \Bx_2 \cdot T }}
%\Bx_2 \cdot \lr{ \Bx_1 \cdot \lr{ +\partial_3 \Bx_4 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ +\partial_3 \Bx_1 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_1 \cdot \lr{ -\partial_3 \Bx_2 \cdot T }}
%\Bx_2 \cdot \lr{ \Bx_4 \cdot \lr{ -\partial_3 \Bx_1 \cdot T }}
%
%\Bx_1 \cdot \lr{ \Bx_3 \cdot \lr{ +\partial_2 \Bx_4 \cdot T }}
%\Bx_1 \cdot \lr{ \Bx_4 \cdot \lr{ -\partial_2 \Bx_3 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ -\partial_2 \Bx_1 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_1 \cdot \lr{ +\partial_2 \Bx_3 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ +\partial_2 \Bx_1 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_1 \cdot \lr{ -\partial_2 \Bx_4 \cdot T }}
%
%\Bx_2 \cdot \lr{ \Bx_3 \cdot \lr{ -\partial_1 \Bx_4 \cdot T }}
%\Bx_2 \cdot \lr{ \Bx_4 \cdot \lr{ +\partial_1 \Bx_3 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_2 \cdot \lr{ +\partial_1 \Bx_4 \cdot T }}
%\Bx_3 \cdot \lr{ \Bx_4 \cdot \lr{ -\partial_1 \Bx_2 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ +\partial_1 \Bx_2 \cdot T }}
%\Bx_4 \cdot \lr{ \Bx_2 \cdot \lr{ -\partial_1 \Bx_3 \cdot T }}
%\end{aligned}
%\end{equation}

} % makeanswer
