%
% Copyright Â© 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\chapter{Some helpful identities}

\input{appendix/wedgeDistributionIdentity.tex}

\maketheorem{Distribution of two bivectors}{thm:stokesTheoremGeometricAlgebra:2300}{
For vectors \(\Ba\), \(\Bb\), and bivector \(B\), we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2320}
\lr{ \Ba \wedge \Bb } \cdot B = \inv{2} \lr{
\Ba \cdot \lr{ \Bb \cdot B }
-\Bb \cdot \lr{ \Ba \cdot B }
}.
\end{equation}
}

Proof follows by applying the scalar selection operator, expanding the wedge product within it, and eliminating any of the terms that cannot contribute grade zero values

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2360}
\lr{ \Ba \wedge \Bb } \cdot B
=
\gpgradezero{
\inv{2} \biglr{ \Ba \Bb - \Bb \Ba } B
}
=
\inv{2}
\gpgradezero{
\Ba \lr{ \Bb \cdot B + \cancel{ \Bb \wedge B } }
-\Bb \lr{ \Ba \cdot B + \cancel{ \Ba \wedge B } }
}
=
\inv{2}
\gpgradezero{
\Ba \cdot \lr{ \Bb \cdot B }
+\cancel{\Ba \wedge \lr{ \Bb \cdot B }}
-\Bb \cdot \lr{ \Ba \cdot B }
-\cancel{\Bb \wedge \lr{ \Ba \cdot B }}
}
=
\inv{2}
\biglr{
\Ba \cdot \lr{ \Bb \cdot B }
-\Bb \cdot \lr{ \Ba \cdot B }
}
\qedmarker
\end{dmath}
\maketheorem{Inner product of trivector with bivector}{thm:stokesTheoremGeometricAlgebra:2460}{

Given a bivector \(B\), and trivector \(\Ba \wedge \Bb \wedge \Bc\) where \(\Ba, \Bb\) and \(\Bc\) are vectors, the inner product is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2480}
\lr{ \Ba \wedge \Bb \wedge \Bc } \cdot B
=
\Ba \biglr{ \lr{ \Bb \wedge \Bc } \cdot B }
+\Bb \biglr{ \lr{ \Bc \wedge \Ba } \cdot B }
+\Bc \biglr{ \lr{ \Ba \wedge \Bb } \cdot B }.
\end{dmath}
}

This is also problem 1.1(c) from Exercises 2.1 in \citep{hestenes1999nfc}, and submits to a dumb expansion in successive dot products with a final regrouping.  With \(B = \Bu \wedge \Bv\)

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2860}
\begin{aligned}
\left(  \Ba \wedge \Bb \wedge \Bc  \right)
\cdot B
&=
\gpgradeone{
\left(  \Ba \wedge \Bb \wedge \Bc \right)
 \left( \Bu \wedge \Bv \right) } \\
&=
\gpgradeone{
\left(  \Ba \wedge \Bb \wedge \Bc  \right)
\left(
\Bu \Bv
- \Bu \cdot \Bv
\right) } \\
&=
\left(
\left(  \Ba \wedge \Bb \wedge \Bc  \right)
 \cdot \Bu \right) \cdot \Bv \\
&=
\left( \Ba \wedge \Bb \right) \cdot \Bv \left( \Bc \cdot \Bu \right)
+
\left( \Bc \wedge \Ba \right) \cdot \Bv \left( \Bb \cdot \Bu \right)
+
\left( \Bb \wedge \Bc \right) \cdot \Bv \left( \Ba \cdot \Bu \right) \\
&=
\Ba
\left(  \Bb \cdot \Bv  \right)
\left( \Bc \cdot \Bu \right)
-\Bb
\left(  \Ba \cdot \Bv  \right)
\left( \Bc \cdot \Bu \right) \\
&\quad +
\Bc
\left(  \Ba \cdot \Bv  \right)
\left( \Bb \cdot \Bu \right)
-
\Ba
\left(  \Bc \cdot \Bv  \right)
\left( \Bb \cdot \Bu \right) \\
&\quad +
\Bb
\left(  \Bc \cdot \Bv  \right)
\left( \Ba \cdot \Bu \right)
-
\Bc
\left(  \Bb \cdot \Bv  \right)
\left( \Ba \cdot \Bu \right) \\
&=
\Ba
\left(  \left(  \Bb \cdot \Bv  \right) \left( \Bc \cdot \Bu \right) - \left(  \Bc \cdot \Bv  \right) \left( \Bb \cdot \Bu \right)  \right)
\\
&\quad +
\Bb
\left(  \left(  \Bc \cdot \Bv  \right) \left( \Ba \cdot \Bu \right) - \left(  \Ba \cdot \Bv  \right) \left( \Bc \cdot \Bu \right)  \right)
\\
&\quad +
\Bc
\left(  \left(  \Ba \cdot \Bv  \right) \left( \Bb \cdot \Bu \right) - \left(  \Bb \cdot \Bv  \right) \left( \Ba \cdot \Bu \right)  \right)
 \\
&=
\Ba
\left(  \Bb \wedge \Bc  \right)
\cdot
\left(  \Bu \wedge \Bv  \right)
\\
&\quad +
\Bb
\left(  \Bc \wedge \Ba  \right)
\cdot
\left(  \Bu \wedge \Bv  \right)
\\
&\quad +
\Bc
\left(  \Ba \wedge \Bb  \right)
 \cdot
\left(  \Bu \wedge \Bv  \right)
\\
&=
\Ba
\left(  \Bb \wedge \Bc  \right)
\cdot B
+
\Bb
\left(  \Bc \wedge \Ba  \right)
 \cdot B
+
\Bc
\left(  \Ba \wedge \Bb  \right)
\cdot B. \qedmarker
\end{aligned}
\end{equation}

\maketheorem{Distribution of two trivectors}{thm:stokesTheoremGeometricAlgebra:2560}{
Given a trivector \(T\) and three vectors \(\Ba, \Bb\), and \(\Bc\), the entire inner product can be expanded in terms of any successive set inner products, subject to change of sign with interchange of any two adjacent vectors within the dot product sequence

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2580}
\lr{ \Ba \wedge \Bb \wedge \Bc } \cdot T
=
 \Ba \cdot \lr{ \Bb \cdot \lr{ \Bc \cdot T } }
=
 -\Ba \cdot \lr{ \Bc \cdot \lr{ \Bb \cdot T } }
=
 \Bb \cdot \lr{ \Bc \cdot \lr{ \Ba \cdot T } }
=
- \Bb \cdot \lr{ \Ba \cdot \lr{ \Bc \cdot T } }
=
 \Bc \cdot \lr{ \Ba \cdot \lr{ \Bb \cdot T } }
=
- \Bc \cdot \lr{ \Bb \cdot \lr{ \Ba \cdot T } }.
\end{dmath}
}

%%%We can first show that an asymmetric expansion of the wedge product gives
%%%
%%%\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2660}
%%%\begin{aligned}
%%%\lr{ \Ba \wedge \Bb \wedge \Bc } \cdot T
%%%&=
%%%\inv{6}
%%%\biglr{
%%% \Ba \cdot \lr{ \Bb \cdot \lr{ \Bc \cdot T } }
%%%-\Ba \cdot \lr{ \Bc \cdot \lr{ \Bb \cdot T } } \\
%%%&\qquad +\Bb \cdot \lr{ \Bc \cdot \lr{ \Ba \cdot T } }
%%%-\Bb \cdot \lr{ \Ba \cdot \lr{ \Bc \cdot T } } \\
%%%&\qquad +\Bc \cdot \lr{ \Ba \cdot \lr{ \Bb \cdot T } }
%%%-\Bc \cdot \lr{ \Bb \cdot \lr{ \Ba \cdot T } }
%%%}.
%%%\end{aligned}
%%%\end{equation}

To show this, we first expand within a scalar selection operator

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:2600}
\begin{aligned}
\lr{ \Ba \wedge \Bb \wedge \Bc } \cdot T
&=
\gpgradezero
{
\lr{ \Ba \wedge \Bb \wedge \Bc } T
} \\
&=
\inv{6}
\gpgradezero
{
  \Ba \Bb \Bc T
- \Ba \Bc \Bb T
+ \Bb \Bc \Ba T
- \Bb \Ba \Bb T
+ \Bc \Ba \Bb T
- \Bc \Bb \Ba T
} \\
\end{aligned}
\end{equation}

Now consider any single term from the scalar selection, such as the first.  This can be reordered using the vector dot product identity

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2680}
\gpgradezero
{
  \Ba \Bb \Bc T
}
=
\gpgradezero
{
  \Ba \lr{ -\Bc \Bb + 2 \Bb \cdot \Bc } T
}
=
-
\gpgradezero
{
  \Ba \Bc \Bb T
}
+
2 \Bb \cdot \Bc \cancel{
\gpgradezero
{
  \Ba T
}
}.
\end{dmath}

The vector-trivector product in the latter grade selection operation above contributes only bivector and quadvector terms, thus contributing nothing.  This can be repeated, showing that

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2700}
  \gpgradezero{ \Ba \Bb \Bc T } =
- \gpgradezero{ \Ba \Bc \Bb T } =
+ \gpgradezero{ \Bb \Bc \Ba T } =
- \gpgradezero{ \Bb \Ba \Bc T } =
+ \gpgradezero{ \Bc \Ba \Bb T } =
- \gpgradezero{ \Bc \Bb \Ba T }.
\end{dmath}

Substituting this back into \eqnref{eqn:stokesTheoremGeometricAlgebra:2600} proves \cref{thm:stokesTheoremGeometricAlgebra:2560}.

%%%, then expand the products from the right, eliminating any terms that cannot contribute to a scalar term
%%%&=
%%%\inv{6}
%%%\gpgradezero
%%%{
%%%  \Ba \Bb \lr{ \Bc \cdot T + \cancel{\Bc \wedge T}}
%%%- \Ba \Bc \lr{ \Bb \cdot T + \cancel{\Bb \wedge T}}
%%%} \\
%%%&
%%%\quad+
%%%\inv{6}
%%%\gpgradezero{
%%%\Bb \Bc \lr{ \Ba \cdot T + \cancel{\Ba \wedge T}}
%%%- \Bb \Ba \lr{ \Bb \cdot T + \cancel{\Bb \wedge T}}
%%%} \\
%%%&
%%%\quad+
%%%\inv{6}
%%%\gpgradezero{
%%%\Bc \Ba \lr{ \Bb \cdot T + \cancel{\Bb \wedge T}}
%%%- \Bc \Bb \lr{ \Ba \cdot T + \cancel{\Ba \wedge T}}
%%%} \\
%%%&=
%%%%%
%%%\inv{6}
%%%\gpgradezero
%%%{
%%%  \Ba \lr{ \Bb \cdot \lr{ \Bc \cdot T } + \cancel{\Bb \wedge \lr{ \Bc \cdot T }}}
%%%- \Ba \lr{ \Bc \cdot \lr{ \Bb \cdot T } + \cancel{\Bc \wedge \lr{ \Bb \cdot T }}}
%%%} \\
%%%&
%%%\quad +
%%%\inv{6}
%%%\gpgradezero
%%%{
%%%\Bb \lr{ \Bc \cdot \lr{ \Ba \cdot T } + \cancel{\Bc \wedge \lr{ \Ba \cdot T }}}
%%%- \Bb \lr{ \Ba \cdot \lr{ \Bb \cdot T } + \cancel{\Ba \wedge \lr{ \Bb \cdot T }}}
%%%} \\
%%%&
%%%\quad +
%%%\inv{6}
%%%\gpgradezero
%%%{
%%%\Bc \lr{ \Ba \cdot \lr{ \Bb \cdot T } + \cancel{\Ba \wedge \lr{ \Bb \cdot T }}}
%%%- \Bc \lr{ \Bb \cdot \lr{ \Ba \cdot T } + \cancel{\Bb \wedge \lr{ \Ba \cdot T }}}
%%%} \\
%%%&=
%%%\inv{6}
%%%\biglr{
%%%  \Ba \cdot \lr{ \Bb \cdot \lr{ \Bc \cdot T } }
%%%- \Ba \cdot \lr{ \Bc \cdot \lr{ \Bb \cdot T } } \\
%%%&\quad + \Bb \cdot \lr{ \Bc \cdot \lr{ \Ba \cdot T } }
%%%- \Bb \cdot \lr{ \Ba \cdot \lr{ \Bb \cdot T } } \\
%%%&\quad + \Bc \cdot \lr{ \Ba \cdot \lr{ \Bb \cdot T } }
%%%- \Bc \cdot \lr{ \Bb \cdot \lr{ \Ba \cdot T } }
%%%}.
%%%\end{aligned}
%%%\end{equation}

\maketheorem{Permutation of two successive dot products with trivector}{thm:stokesTheoremGeometricAlgebra:2740}{
Given a trivector \(T\) and two vectors \(\Ba\) and \(\Bb\), alternating the order of the dot products changes the sign

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2760}
\Ba \cdot \lr{ \Bb \cdot T }
=
-\Bb \cdot \lr{ \Ba \cdot T }.
\end{dmath}
}

This and \cref{thm:stokesTheoremGeometricAlgebra:2560} are clearly examples of a more general identity, but I'll not try to prove that here.  To show this one, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:2780}
\Ba \cdot \lr{ \Bb \cdot T }
=
\gpgradeone{ \Ba \lr{ \Bb \cdot T } }
=
\inv{2}
\gpgradeone{ \Ba \Bb T + \Ba T \Bb }
=
\inv{2}
\gpgradeone{ \lr{ -\Bb \Ba + \cancel{2 \Ba \cdot \Bb}} T + \lr{ \Ba \cdot T} \Bb + \cancel{ \Ba \wedge T} \Bb }
= \inv{2}
\lr{
-\Bb \cdot \lr{ \Ba \cdot T }
+\lr{ \Ba \cdot T } \cdot \Bb
}
=
-\Bb \cdot \lr{ \Ba \cdot T }. \qedmarker
\end{dmath}

Cancellation of terms above was because they could not contribute to a grade one selection.   We also employed the relation \(\Bx \cdot B = - B \cdot \Bx\) for bivector \(B\) and vector \(\Bx\).

\maketheorem{Duality in a plane}{thm:stokesTheoremGeometricAlgebra:3200}{

\index{dual}
For a vector \(\Ba\), and a plane containing \(\Ba\) and \(\Bb\), the dual \(\Ba^\conj\) of this vector with respect to this plane is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3220}
\Ba^\conj = \frac{\Bb \cdot \lr{ \Ba \wedge \Bb }}{\lr{\Ba \wedge \Bb}^2},
\end{dmath}

Satisfying

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3240}
\Ba^\conj \cdot \Ba = 1,
\end{dmath}

and

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3260}
\Ba^\conj \cdot \Bb = 0.
\end{dmath}
}

To demonstrate, we start with the expansion of

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3280}
\Bb \cdot \lr{ \Ba \wedge \Bb }
=
\lr{ \Bb \cdot \Ba } \Bb
-\Bb^2 \Ba.
\end{dmath}

Dotting with \(\Ba\) we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3300}
\Ba \cdot \lr{ \Bb \cdot \lr{ \Ba \wedge \Bb } }
=
\Ba \cdot \lr{
\lr{ \Bb \cdot \Ba } \Bb
-\Bb^2 \Ba
}
=
\lr{ \Bb \cdot \Ba }^2 - \Bb^2 \Ba^2,
\end{dmath}

but dotting with \(\Bb\) yields zero

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3320}
\Bb \cdot \lr{ \Bb \cdot \lr{ \Ba \wedge \Bb } }
=
\Bb \cdot \lr{
\lr{ \Bb \cdot \Ba } \Bb
-\Bb^2 \Ba
}
=
\lr{ \Bb \cdot \Ba } \Bb^2 - \Bb^2 \lr{ \Ba \cdot \Bb }
= 0.
\end{dmath}

To complete the proof, we note that the product in \eqnref{eqn:stokesTheoremGeometricAlgebra:3300} is just the wedge squared

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:3340}
\lr{ \Ba \wedge \Bb}^2
=
\gpgradezero{
\lr{ \Ba \wedge \Bb }^2
}
=
\gpgradezero{
\lr{ \Ba \Bb - \Ba \cdot \Bb }
\lr{ \Ba \Bb - \Ba \cdot \Bb }
}
=
\gpgradezero{
\Ba \Bb \Ba \Bb - 2 \lr{\Ba \cdot \Bb} \Ba \Bb
}
+
\lr{ \Ba \cdot \Bb }^2
=
\gpgradezero{
\Ba \Bb \lr{ -\Bb \Ba + 2 \Ba \cdot \Bb }
}
-
\lr{ \Ba \cdot \Bb }^2
=
\lr{ \Ba \cdot \Bb }^2
-\Ba^2 \Bb^2.
\end{dmath}

This duality relation can be recast with a linear denominator

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4850}
\Ba^\conj
= \frac{\Bb \cdot \lr{ \Ba \wedge \Bb }}{\lr{\Ba \wedge \Bb}^2}
= \Bb \frac{\Ba \wedge \Bb }{\lr{\Ba \wedge \Bb}^2}
= \Bb \frac{\Ba \wedge \Bb }{\Abs{\Ba \wedge \Bb }}
      \frac{\Abs{\Ba \wedge \Bb}}{\Ba \wedge \Bb }
\inv{\lr{\Ba \wedge \Bb}},
\end{dmath}

or
\boxedEquation{eqn:stokesTheoremGeometricAlgebra:4870}{
\Ba^\conj
= \Bb \inv{\lr{\Ba \wedge \Bb}}.
}

We can use this form after scaling it appropriately to express duality in terms of the pseudoscalar.

\maketheorem{Dual vector in a three vector subspace}{thm:stokesTheoremGeometricAlgebra:4950}{
In the subspace spanned by \(\setlr{\Ba, \Bb, \Bc}\), the dual of \(\Ba\) is

\begin{equation*}
\Ba^\conj = \Bb \wedge \Bc \inv{\Ba \wedge \Bb \wedge \Bc},
\end{equation*}

}

Consider the dot product of \(\acap^\conj\) with \(\Bu \in \setlr{\Ba, \Bb, \Bc}\).

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4970}
\Bu \cdot \Ba^\conj
=
\gpgradezero{ \Bu \Bb \wedge \Bc \inv{\Ba \wedge \Bb \wedge \Bc} }
=
\gpgradezero{ \Bu \cdot \lr{ \Bb \wedge \Bc} \inv{\Ba \wedge \Bb \wedge \Bc} }
+
\gpgradezero{ \Bu \wedge \Bb \wedge \Bc \inv{\Ba \wedge \Bb \wedge \Bc} }
=
\cancel{\gpgradezero{
\lr{
\lr{ \Bu \cdot \Bb} \Bc
-\lr{\Bu \cdot \Bc} \Bb
}
\inv{\Ba \wedge \Bb \wedge \Bc} }
}
+
\gpgradezero{ \Bu \wedge \Bb \wedge \Bc \inv{\Ba \wedge \Bb \wedge \Bc} }.
\end{dmath}

The canceled term is eliminated since it is the product of a vector and trivector producing no scalar term.  Substituting \(\Ba, \Bb, \Bc\), and noting that \(\Bu \wedge \Bu = 0\), we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebra:4990}
\begin{aligned}
\Ba \cdot \Ba^\conj &= 1 \\
\Bb \cdot \Ba^\conj &= 0 \\
\Bc \cdot \Ba^\conj &= 0.
\end{aligned}
\end{equation}

\maketheorem{Pseudoscalar selection}{thm:stokesTheoremGeometricAlgebra:4690}{

For grade \(k\) blade \(K \in \bigwedge^k\) (i.e. a \textAndIndex{pseudoscalar}), and vectors \(\Ba, \Bb\), the grade \(k\) selection of this blade sandwiched between the vectors is

\begin{equation*}
\gpgrade{ \Ba K \Bb }{k} = (-1)^{k+1} \gpgrade{K a b}{k} = (-1)^{k+1} K \lr{ \Ba \cdot \Bb}.
\end{equation*}
}

To show this, we have to consider even and odd grades separately.  First for even \(k\) we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4710}
\gpgrade{ \Ba K \Bb }{k}
=
\gpgrade{ \lr{ \Ba \cdot K + \cancel{\Ba \wedge K}} \Bb }{k}
=
\inv{2} \gpgrade{ \lr{ \Ba K - K \Ba } \Bb }{k}
=
\inv{2} \gpgrade{ \Ba K \Bb }{k}
-\inv{2} \gpgrade{ K \Ba \Bb }{k},
\end{dmath}

or
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4730}
\gpgrade{ \Ba K \Bb }{k} = -\gpgrade{ K \Ba \Bb }{k} = -K \lr{ \Ba \cdot \Bb}.
\end{dmath}

Similarly for odd \(k\), we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:4790}
\gpgrade{ \Ba K \Bb }{k}
=
\gpgrade{ \lr{ \Ba \cdot K + \cancel{\Ba \wedge K}} \Bb }{k}
=
\inv{2} \gpgrade{ \lr{ \Ba K + K \Ba } \Bb }{k}
=
\inv{2} \gpgrade{ \Ba K \Bb }{k}
+\inv{2} \gpgrade{ K \Ba \Bb }{k},
\end{dmath}

or
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebra:5310}
\gpgrade{ \Ba K \Bb }{k} = \gpgrade{ K \Ba \Bb }{k} = K \lr{ \Ba \cdot \Bb}.
\end{dmath}

Adjusting for the signs completes the proof.
