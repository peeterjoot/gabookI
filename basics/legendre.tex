%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\chapter{Legendre Polynomials}
\index{Legendre polynomial}
\label{chap:legendre}
%\date{Feb 4, 2008.  legendre.tex}

Exercise 8.4, from \citep{hestenes1999nfc}.

Find the first couple terms of the Legendre polynomial expansion of

\begin{equation}\label{eqn:legendre:20}
\inv{\abs{\Bx - \Ba}}
\end{equation}

Write

\begin{equation}\label{eqn:legendre:40}
f(x) = \inv{\abs{\Bx}}
\end{equation}

Expanding \(f(\Bx - \Ba)\) about \(\Bx\) we have

\begin{equation}\label{eqn:legendre:60}
\inv{\abs{\Bx - \Ba}} =
\sum_{k=0}{ \inv{k!} (-\agrad)^k} \inv{\abs{\Bx}}
\end{equation}

Expanding the first term we have

\begin{equation}\label{eqn:legendre:200}
\begin{aligned}
-\agrad \inv{\abs{\Bx}}
&=
\inv{{\abs{\Bx}}^2} \agrad {\abs{\Bx}} \\
&=
\inv{{\abs{\Bx}}^2} \agrad (\Bx^2)^{1/2} \\
&=
\inv{{\abs{\Bx}}^2} \frac{(1/2)}{({\abs{\Bx}}^2)^{1/2}}\agrad \Bx^2 \\
&=
\frac{\Ba \cdot \Bx}{{\abs{\Bx}}^3}
\end{aligned}
\end{equation}

Expansion of the second derivative term is
\begin{equation}\label{eqn:legendre:220}
\begin{aligned}
\frac{(-\agrad)}{2}\frac{(-\agrad)}{1}\inv{\abs{\Bx}}
&=
\frac{\agrad}{2} \left(\frac{-\Ba \cdot \Bx}{{\abs{\Bx}}^3}\right) \\
&=
\frac{-1}{2}
\left(
\frac{\agrad {(\Ba \cdot \Bx)}}{{\abs{\Bx}}^3} + {(\Ba \cdot \Bx)}\agrad \inv{{\abs{\Bx}}^3} \right) \\
\end{aligned}
\end{equation}

For this we need
\begin{equation}\label{eqn:legendre:80}
\agrad {(\Ba \cdot \Bx)} =
\Ba \cdot (\agrad {\Bx}) = \Ba^2
\end{equation}

And
\begin{equation}\label{eqn:legendre:240}
\begin{aligned}
\agrad \inv{{\abs{\Bx}}^k}
&=
k \inv{{\abs{\Bx}}^{k-1}} \agrad \inv{{\abs{\Bx}}} \\
&=
k \inv{{\abs{\Bx}}^{k-1}} \frac{- \Ba \cdot \Bx }{{\abs{\Bx}}^3} \\
&=
-k \frac{\Ba \cdot \Bx }{{\abs{\Bx}}^{k+2}} \\
\end{aligned}
\end{equation}

Thus the second derivative term is
\begin{equation}\label{eqn:legendre:260}
\begin{aligned}
\frac{-1}{2}
\left(
\frac{\Ba^2}{{\abs{\Bx}}^3} -3 \frac{(\Ba \cdot \Bx)^2} {{\abs{\Bx}}^5} \right)
=
\frac{ (1/2)\left( 3 (\Ba \cdot \Bx)^2 - \Ba^2 \Bx^2 \right) }
{ {{\abs{\Bx}}^5} }
\end{aligned}
\end{equation}

Summing these terms we have

\begin{equation}\label{eqn:legendre:100}
\inv{\abs{\Bx -\Ba}} =
\inv{\abs{\Bx}} +
\frac{ \Ba \cdot \Bx } { {\abs{\Bx}}^3 } +
\frac{ (1/2)\left( 3 (\Ba \cdot \Bx)^2 - \Ba^2 \Bx^2 \right) } { {{\abs{\Bx}}^5} } + \cdots
\end{equation}

NFCM writes this as
\begin{equation}\label{eqn:legendre:120}
\inv{\abs{\Bx -\Ba}} =
\frac{ P_0(\bxa) } {  \abs{\Bx}} +
\frac{ P_1(\bxa) } { {\abs{\Bx}}^3 } +
\frac{ P_2(\bxa) } { {\abs{\Bx}}^5 } + \cdots
\end{equation}

And calls \(P_i = P_i(\bxa)\) terms the Legendre polynomials.  This is not terribly clear since one expects a different form for the Legendre polynomials.

Using the Taylor formula one can derive a recurrence relation for these that makes the calculation a bit
simpler

\begin{equation}\label{eqn:legendre:280}
\begin{aligned}
\frac{P_{k+1}}{\abs{\Bx}^{2(k+1)+1}}
&= \frac{-\agrad}{k+1}\left(\frac{P_k}{\abs{\Bx}^{2k+1}}\right) \\
&=
\frac{-1}{k+1}
\left(
\frac{\agrad({P_k}}
{\abs{\Bx}^{2k+1}}
+
{P_k}\frac{\agrad}
{\abs{\Bx}^{2k+1}}
\right) \\
&=
\inv{k+1}
\left(
{P_k}(2k+1) \frac{\Ba \cdot \Bx}
{\abs{\Bx}^{2k+3}}
-\Bx^2 \frac{\agrad{P_k}}
{\abs{\Bx}^{2k+3}}
\right) \\
\end{aligned}
\end{equation}

Or
\begin{equation}\label{eqn:legendre:300}
\begin{aligned}
(k+1){P_{k+1}}
=
{P_k}(2k+1) {\Ba \cdot \Bx}
-\Bx^2 {\agrad{P_k}}
\end{aligned}
\end{equation}

Some of these have been calculated

\begin{equation}\label{eqn:legendre:320}
\begin{aligned}
P_0 &= 1 \\
P_1 &= \Ba \cdot \Bx \\
P_2 &= \half(3(\Ba \cdot \Bx)^2 -\Ba^2\Bx^2) \\
\end{aligned}
\end{equation}

And for the derivatives

\begin{equation}\label{eqn:legendre:340}
\begin{aligned}
\agrad P_0 &= 0 \\
\agrad P_1 &= \Ba^2 \\
\agrad P_2 &= \half((3)(2)(\Ba \cdot \Bx)\Ba^2 - 2\Ba^2\Bx \cdot \Ba) \\
           &= 2\Ba^2(\Bx \cdot \Ba) \\
\end{aligned}
\end{equation}

Using the recurrence relation one can calculate \(P_3\) for example.

\begin{equation}\label{eqn:legendre:360}
\begin{aligned}
P_3
%(k+1){P_{k+1}} ; k=2
&=
(1/3)\left(
\frac{5}{2}(3(\Ba \cdot \Bx)^2 -\Ba^2\Bx^2)({\Ba \cdot \Bx})
- 2 \Bx^2 \Ba^2(\Bx \cdot \Ba) \right) \\
&=
(1/3) ({\Ba \cdot \Bx}) \left(
\frac{5}{2}(3(\Ba \cdot \Bx)^2 -\Ba^2\Bx^2)
- 2 \Bx^2 \Ba^2 \right) \\
&=
({\Ba \cdot \Bx}) \left( \frac{5}{2}((\Ba \cdot \Bx)^2 ) - 3/2 \Bx^2 \Ba^2 \right) \\
&=
\half({\Ba \cdot \Bx}) ( {5}(\Ba \cdot \Bx)^2 - 3 \Bx^2 \Ba^2 ) \\
\end{aligned}
\end{equation}

\section{ Putting things in standard Legendre polynomial form}

This is still pretty laborious to calculate, especially because of not having a closed form recurrence
relation for \(\agrad P_k\).  Let us relate these to the standard Legendre polynomial form.

Observe that we can write

\begin{equation}\label{eqn:legendre:380}
\begin{aligned}
P_0(\bxa) &= 1 \\
\frac{P_1(\bxa)}{\abs{\Bx} \abs{\Ba}} &= \costheta \\
\frac{P_2(\bxa)}{\abs{\Bx}^2 \abs{\Ba}^2} &= \half(3(\costheta)^2 - 1) \\
\frac{P_3(\bxa)}{\abs{\Bx}^3 \abs{\Ba}^3} &= \half ( {5}(\costheta)^3 - 3 {(\costheta)} ) \\
\end{aligned}
\end{equation}

With this scaling, we have the standard form for the Legendre polynomials, and can write

\begin{equation}\label{eqn:legendre:140}
\inv{\Bx-\Ba} = \inv{\abs{\Bx}}\left(
P_0
+ \frac{\abs{\Ba}}{\abs{\Bx}} P_1(\costheta)
+ \left(\frac{\abs{\Ba}}{\abs{\Bx}}\right)^2 P_2(\costheta)
+ \left(\frac{\abs{\Ba}}{\abs{\Bx}}\right)^3 P_3(\costheta)
+ \cdots \right)
\end{equation}

\section{ Scaling standard form Legendre polynomials}

Since the odd Legendre polynomials have only odd terms and even have only even terms this allows for
the scaled form that NFCM uses.

\begin{equation}\label{eqn:legendre:400}
\begin{aligned}
P_0(\bxa) &= P_0(\costheta) \\
P_1(\bxa) &= \abs{\Bx}\abs{\Ba} P_1(\costheta) = \Ba \cdot \Bx \\
P_2(\bxa) &= \abs{\Bx}^2\abs{\Ba}^2 P_2(\costheta) = \half(3(\Ba \cdot \Bx)^2 - \Bx^2\Ba^2) \\
P_3(\bxa) &= \abs{\Bx}^3\abs{\Ba}^3 P_3(\costheta) = \half(5(\Ba \cdot \Bx)^3 - 3(\Ba \cdot \Bx) \Bx^2\Ba^2) \\
\end{aligned}
\end{equation}

Every term for the \(k^{th}\) polynomial is a permutation of the geometric product \(\Bx^k\Ba^k\).

This allows for writing some of these terms using the wedge product.  Using the product expansion:

\begin{equation}\label{eqn:legendre:160}
%\Ba \Bx \Bx \Ba = \Ba^2 \Bx^2 = (\Ba \cdot \Bx + \Ba \wedge \Bx)(\Bx \cdot \Ba + \Bx \wedge \Ba) = (\Ba \cdot \Bx)^2 - ( \Ba \wedge \Bx )^2
%\Ba^2 \Bx^2 = (\Ba \cdot \Bx)^2 - ( \Ba \wedge \Bx )^2
(\Ba \cdot \Bx)^2 = ( \Ba \wedge \Bx )^2 + \Ba^2 \Bx^2
\end{equation}

Thus we have:
\begin{equation}\label{eqn:legendre:420}
\begin{aligned}
P_2(\bxa)
&= (\Ba \cdot \Bx)^2 + \half(\Ba \wedge \Bx)^2 \\
&= (\Ba \cdot \Bx)^2 - \half\abs{\Ba \wedge \Bx}^2 \\
\end{aligned}
\end{equation}

This is nice geometrically since the directional dependence of this term on the co-linearity and
perpendicularity of the vectors \(\Ba\) and \(\Bx\) is clear.

Doing the same for the \(P_3\):

\begin{equation}\label{eqn:legendre:440}
\begin{aligned}
P_3(\bxa) &= (\Ba \cdot \Bx)\half(5(\Ba \cdot \Bx)^2 - 3\Bx^2\Ba^2) \\
          &= (\Ba \cdot \Bx)\half(2(\Ba \cdot \Bx)^2 + 3(\Ba \wedge \Bx)^2) \\
          &= (\Ba \cdot \Bx)((\Ba \cdot \Bx)^2 - \frac{3}{2}\abs{\Ba \wedge \Bx}^2) \\
\end{aligned}
\end{equation}

I suppose that one could get the same geometrical interpretation with a standard Legendre expansion in terms of \(\costheta = cos(\theta)\) terms, by collect both \(sin(\theta)\) and \(cos(\theta)\) powers, but one
can see the power of writing things explicitly in terms of the original vectors.

\section{ Note on NFCM Legendre polynomial notation}

In NFCM's slightly abusive notation \(P_k\) was used with various meanings.  He wrote \(P_k(\costheta) = \frac{P_k(\bxa)}{\abs{\Bx}^k \abs{\Ba}^k}\).

Note for example that the standard first degree Legendre polynomial \(P_1(x) = x\) evaluated with a \(\bxa\) value:

\begin{equation}\label{eqn:legendre:460}
\begin{aligned}
\inv {\abs{\Bx}\abs{\Ba}} {P_1(x) \vert_{x=\bxa}} &= \xcap \acap \\
&= \xcap \cdot \acap + \xcap \wedge \acap \\
\end{aligned}
\end{equation}

This has a bivector component in addition to the component identical to the standard Legendre polynomial
term (the first part).

By luck it happens that the scalar part of this equals \(P_1(\costheta)\), but this
is not the case for other terms.  Example, \(P_2(\bxa)\):

\begin{equation}\label{eqn:legendre:480}
\begin{aligned}
{P_2(x) \vert_{x=\bxa}}
&= \half( 3(\Bx \Ba)^2 - 1 ) \\
&= \half( 3(-\Ba \Bx + 2 \Ba \cdot \Bx )(\Bx \Ba) - 1 ) \\
&= \half( 3(-\Ba^2 \Bx^2 + 2(\Ba \cdot \Bx)^2 + 2(\Ba \cdot \Bx)(\Bx \wedge \Ba)) - 1 ) \\
&=  -(3/2)\Ba^2 \Bx^2 + 3(\Ba \cdot \Bx)^2 + 3(\Ba \cdot \Bx)(\Bx \wedge \Ba) - 1/2  \\
\end{aligned}
\end{equation}

Scaling this by \(1/(\Ba^2\Bx^2)\) is
\begin{equation}\label{eqn:legendre:180}
-\frac{3}{2} + 3(\costheta)^2 + 3(\costheta)(\xcap \wedge \acap) - \inv{\Ba^2\Bx^2} \\
\end{equation}

The scalar part of this is not anything recognizable.
